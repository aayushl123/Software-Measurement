<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Base64Test.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_codec$Jacoco.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.codec.binary</a> &gt; <span class="el_source">Base64Test.java</span></div><h1>Base64Test.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */

package org.apache.commons.codec.binary;

import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertFalse;
import static org.junit.Assert.assertNotNull;
import static org.junit.Assert.assertTrue;
import static org.junit.Assert.fail;

import java.math.BigInteger;
import java.util.Arrays;
import java.util.Random;

import org.apache.commons.codec.Charsets;
import org.apache.commons.codec.DecoderException;
import org.apache.commons.codec.EncoderException;
import org.junit.Ignore;
import org.junit.Test;

/**
 * Test cases for Base64 class.
 *
 * @see &lt;a href=&quot;http://www.ietf.org/rfc/rfc2045.txt&quot;&gt;RFC 2045&lt;/a&gt;
 * @version $Id$
 */
<span class="fc" id="L42">public class Base64Test {</span>

<span class="fc" id="L44">    private final Random random = new Random();</span>

    /**
     * @return Returns the random.
     */
    public Random getRandom() {
<span class="fc" id="L50">        return this.random;</span>
    }

    /**
     * Test the isStringBase64 method.
     */
    @Test
    public void testIsStringBase64() {
<span class="fc" id="L58">        final String nullString = null;</span>
<span class="fc" id="L59">        final String emptyString = &quot;&quot;;</span>
<span class="fc" id="L60">        final String validString = &quot;abc===defg\n\r123456\r789\r\rABC\n\nDEF==GHI\r\nJKL==============&quot;;</span>
<span class="fc" id="L61">        final String invalidString = validString + (char)0; // append null character</span>

        try {
<span class="nc" id="L64">            Base64.isBase64(nullString);</span>
<span class="nc" id="L65">            fail(&quot;Base64.isStringBase64() should not be null-safe.&quot;);</span>
<span class="fc" id="L66">        } catch (final NullPointerException npe) {</span>
<span class="fc" id="L67">            assertNotNull(&quot;Base64.isStringBase64() should not be null-safe.&quot;, npe);</span>
<span class="nc" id="L68">        }</span>

<span class="fc" id="L70">        assertTrue(&quot;Base64.isStringBase64(empty-string) is true&quot;, Base64.isBase64(emptyString));</span>
<span class="fc" id="L71">        assertTrue(&quot;Base64.isStringBase64(valid-string) is true&quot;, Base64.isBase64(validString));</span>
<span class="fc" id="L72">        assertFalse(&quot;Base64.isStringBase64(invalid-string) is false&quot;, Base64.isBase64(invalidString));</span>
<span class="fc" id="L73">    }</span>

    /**
     * Test the Base64 implementation
     */
    @Test
    public void testBase64() {
<span class="fc" id="L80">        final String content = &quot;Hello World&quot;;</span>
        String encodedContent;
<span class="fc" id="L82">        byte[] encodedBytes = Base64.encodeBase64(StringUtils.getBytesUtf8(content));</span>
<span class="fc" id="L83">        encodedContent = StringUtils.newStringUtf8(encodedBytes);</span>
<span class="fc" id="L84">        assertEquals(&quot;encoding hello world&quot;, &quot;SGVsbG8gV29ybGQ=&quot;, encodedContent);</span>

<span class="fc" id="L86">        Base64 b64 = new Base64(BaseNCodec.MIME_CHUNK_SIZE, null);  // null lineSeparator same as saying no-chunking</span>
<span class="fc" id="L87">        encodedBytes = b64.encode(StringUtils.getBytesUtf8(content));</span>
<span class="fc" id="L88">        encodedContent = StringUtils.newStringUtf8(encodedBytes);</span>
<span class="fc" id="L89">        assertEquals(&quot;encoding hello world&quot;, &quot;SGVsbG8gV29ybGQ=&quot;, encodedContent);</span>

<span class="fc" id="L91">        b64 = new Base64(0, null);  // null lineSeparator same as saying no-chunking</span>
<span class="fc" id="L92">        encodedBytes = b64.encode(StringUtils.getBytesUtf8(content));</span>
<span class="fc" id="L93">        encodedContent = StringUtils.newStringUtf8(encodedBytes);</span>
<span class="fc" id="L94">        assertEquals(&quot;encoding hello world&quot;, &quot;SGVsbG8gV29ybGQ=&quot;, encodedContent);</span>

        // bogus characters to decode (to skip actually) {e-acute*6}
<span class="fc" id="L97">        final byte[] decode = b64.decode(&quot;SGVsbG{\u00e9\u00e9\u00e9\u00e9\u00e9\u00e9}8gV29ybGQ=&quot;);</span>
<span class="fc" id="L98">        final String decodeString = StringUtils.newStringUtf8(decode);</span>
<span class="fc" id="L99">        assertEquals(&quot;decode hello world&quot;, &quot;Hello World&quot;, decodeString);</span>
<span class="fc" id="L100">    }</span>

    /**
     * Test our decode with pad character in the middle.
     * (Our current implementation:  halt decode and return what we've got so far).
     *
     * The point of this test is not to say &quot;this is the correct way to decode base64.&quot;
     * The point is simply to keep us aware of the current logic since 1.4 so we
     * don't accidentally break it without realizing.
     *
     * Note for historians.  The 1.3 logic would decode to:
     * &quot;Hello World\u0000Hello World&quot; -- null in the middle ---
     * and 1.4 unwittingly changed it to current logic.
     */
    @Test
    public void testDecodeWithInnerPad() {
<span class="fc" id="L116">        final String content = &quot;SGVsbG8gV29ybGQ=SGVsbG8gV29ybGQ=&quot;;</span>
<span class="fc" id="L117">        byte[] result = Base64.decodeBase64(content);</span>
<span class="fc" id="L118">        byte[] shouldBe = StringUtils.getBytesUtf8(&quot;Hello World&quot;);</span>
<span class="fc" id="L119">        assertTrue(&quot;decode should halt at pad (=)&quot;, Arrays.equals(result, shouldBe));</span>
<span class="fc" id="L120">    }</span>

    /**
     * Tests Base64.encodeBase64().
     */
    @Test
    public void testChunkedEncodeMultipleOf76() {
<span class="fc" id="L127">        final byte[] expectedEncode = Base64.encodeBase64(Base64TestData.DECODED, true);</span>
        // convert to &quot;\r\n&quot; so we're equal to the old openssl encoding test stored
        // in Base64TestData.ENCODED_76_CHARS_PER_LINE:
<span class="fc" id="L130">        final String actualResult = Base64TestData.ENCODED_76_CHARS_PER_LINE.replaceAll(&quot;\n&quot;, &quot;\r\n&quot;);</span>
<span class="fc" id="L131">        final byte[] actualEncode = StringUtils.getBytesUtf8(actualResult);</span>
<span class="fc" id="L132">        assertTrue(&quot;chunkedEncodeMultipleOf76&quot;, Arrays.equals(expectedEncode, actualEncode));</span>
<span class="fc" id="L133">    }</span>

    /**
     * CODEC-68: isBase64 throws ArrayIndexOutOfBoundsException on some non-BASE64 bytes
     */
    @Test
    public void testCodec68() {
<span class="fc" id="L140">        final byte[] x = new byte[]{'n', 'A', '=', '=', (byte) 0x9c};</span>
<span class="fc" id="L141">        Base64.decodeBase64(x);</span>
<span class="fc" id="L142">    }</span>

    @Test
    public void testCodeInteger1() {
<span class="fc" id="L146">        final String encodedInt1 = &quot;li7dzDacuo67Jg7mtqEm2TRuOMU=&quot;;</span>
<span class="fc" id="L147">        final BigInteger bigInt1 = new BigInteger(&quot;85739377120809420210425962799&quot; + &quot;0318636601332086981&quot;);</span>

<span class="fc" id="L149">        assertEquals(encodedInt1, new String(Base64.encodeInteger(bigInt1)));</span>
<span class="fc" id="L150">        assertEquals(bigInt1, Base64.decodeInteger(encodedInt1.getBytes(Charsets.UTF_8)));</span>
<span class="fc" id="L151">    }</span>

    @Test
    public void testCodeInteger2() {
<span class="fc" id="L155">        final String encodedInt2 = &quot;9B5ypLY9pMOmtxCeTDHgwdNFeGs=&quot;;</span>
<span class="fc" id="L156">        final BigInteger bigInt2 = new BigInteger(&quot;13936727572861167254666467268&quot; + &quot;91466679477132949611&quot;);</span>

<span class="fc" id="L158">        assertEquals(encodedInt2, new String(Base64.encodeInteger(bigInt2)));</span>
<span class="fc" id="L159">        assertEquals(bigInt2, Base64.decodeInteger(encodedInt2.getBytes(Charsets.UTF_8)));</span>
<span class="fc" id="L160">    }</span>

    @Test
    public void testCodeInteger3() {
<span class="fc" id="L164">        final String encodedInt3 = &quot;FKIhdgaG5LGKiEtF1vHy4f3y700zaD6QwDS3IrNVGzNp2&quot; + &quot;rY+1LFWTK6D44AyiC1n8uWz1itkYMZF0/aKDK0Yjg==&quot;;</span>
<span class="fc" id="L165">        final BigInteger bigInt3 = new BigInteger(&quot;10806548154093873461951748545&quot;</span>
            + &quot;1196989136416448805819079363524309897749044958112417136240557&quot;
            + &quot;4495062430572478766856090958495998158114332651671116876320938126&quot;);

<span class="fc" id="L169">        assertEquals(encodedInt3, new String(Base64.encodeInteger(bigInt3)));</span>
<span class="fc" id="L170">        assertEquals(bigInt3, Base64.decodeInteger(encodedInt3.getBytes(Charsets.UTF_8)));</span>
<span class="fc" id="L171">    }</span>

    @Test
    public void testCodeInteger4() {
<span class="fc" id="L175">        final String encodedInt4 = &quot;ctA8YGxrtngg/zKVvqEOefnwmViFztcnPBYPlJsvh6yKI&quot;</span>
            + &quot;4iDm68fnp4Mi3RrJ6bZAygFrUIQLxLjV+OJtgJAEto0xAs+Mehuq1DkSFEpP3o&quot;
            + &quot;DzCTOsrOiS1DwQe4oIb7zVk/9l7aPtJMHW0LVlMdwZNFNNJoqMcT2ZfCPrfvYv&quot;
            + &quot;Q0=&quot;;
<span class="fc" id="L179">        final BigInteger bigInt4 = new BigInteger(&quot;80624726256040348115552042320&quot;</span>
            + &quot;6968135001872753709424419772586693950232350200555646471175944&quot;
            + &quot;519297087885987040810778908507262272892702303774422853675597&quot;
            + &quot;748008534040890923814202286633163248086055216976551456088015&quot;
            + &quot;338880713818192088877057717530169381044092839402438015097654&quot;
            + &quot;53542091716518238707344493641683483917&quot;);

<span class="fc" id="L186">        assertEquals(encodedInt4, new String(Base64.encodeInteger(bigInt4)));</span>
<span class="fc" id="L187">        assertEquals(bigInt4, Base64.decodeInteger(encodedInt4.getBytes(Charsets.UTF_8)));</span>
<span class="fc" id="L188">    }</span>

    @Test
    public void testCodeIntegerEdgeCases() {
        // TODO
<span class="fc" id="L193">    }</span>

    @Test
    public void testCodeIntegerNull() {
        try {
<span class="nc" id="L198">            Base64.encodeInteger(null);</span>
<span class="nc" id="L199">            fail(&quot;Exception not thrown when passing in null to encodeInteger(BigInteger)&quot;);</span>
<span class="fc" id="L200">        } catch (final NullPointerException npe) {</span>
            // expected
<span class="nc" id="L202">        } catch (final Exception e) {</span>
<span class="nc" id="L203">            fail(&quot;Incorrect Exception caught when passing in null to encodeInteger(BigInteger)&quot;);</span>
<span class="pc" id="L204">        }</span>
<span class="fc" id="L205">    }</span>

    @Test
    public void testConstructors() {
        Base64 base64;
<span class="fc" id="L210">        base64 = new Base64();</span>
<span class="fc" id="L211">        base64 = new Base64(-1);</span>
<span class="fc" id="L212">        base64 = new Base64(-1, new byte[]{});</span>
<span class="fc" id="L213">        base64 = new Base64(64, new byte[]{});</span>
        try {
<span class="nc" id="L215">            base64 = new Base64(-1, new byte[]{'A'}); // TODO do we need to check sep if len = -1?</span>
<span class="nc" id="L216">            fail(&quot;Should have rejected attempt to use 'A' as a line separator&quot;);</span>
<span class="fc" id="L217">        } catch (final IllegalArgumentException ignored) {</span>
            // Expected
<span class="nc" id="L219">        }</span>
        try {
<span class="nc" id="L221">            base64 = new Base64(64, new byte[]{'A'});</span>
<span class="nc" id="L222">            fail(&quot;Should have rejected attempt to use 'A' as a line separator&quot;);</span>
<span class="fc" id="L223">        } catch (final IllegalArgumentException ignored) {</span>
            // Expected
<span class="nc" id="L225">        }</span>
        try {
<span class="nc" id="L227">            base64 = new Base64(64, new byte[]{'='});</span>
<span class="nc" id="L228">            fail(&quot;Should have rejected attempt to use '=' as a line separator&quot;);</span>
<span class="fc" id="L229">        } catch (final IllegalArgumentException ignored) {</span>
            // Expected
<span class="nc" id="L231">        }</span>
<span class="fc" id="L232">        base64 = new Base64(64, new byte[]{'$'}); // OK</span>
        try {
<span class="nc" id="L234">            base64 = new Base64(64, new byte[]{'A', '$'});</span>
<span class="nc" id="L235">            fail(&quot;Should have rejected attempt to use 'A$' as a line separator&quot;);</span>
<span class="fc" id="L236">        } catch (final IllegalArgumentException ignored) {</span>
            // Expected
<span class="nc" id="L238">        }</span>
<span class="fc" id="L239">        base64 = new Base64(64, new byte[]{' ', '$', '\n', '\r', '\t'}); // OK</span>
<span class="fc" id="L240">        assertNotNull(base64);</span>
<span class="fc" id="L241">    }</span>

    @Test
    public void testConstructor_Int_ByteArray_Boolean() {
<span class="fc" id="L245">        final Base64 base64 = new Base64(65, new byte[]{'\t'}, false);</span>
<span class="fc" id="L246">        final byte[] encoded = base64.encode(Base64TestData.DECODED);</span>
<span class="fc" id="L247">        String expectedResult = Base64TestData.ENCODED_64_CHARS_PER_LINE;</span>
<span class="fc" id="L248">        expectedResult = expectedResult.replace('\n', '\t');</span>
<span class="fc" id="L249">        final String result = StringUtils.newStringUtf8(encoded);</span>
<span class="fc" id="L250">        assertEquals(&quot;new Base64(65, \\t, false)&quot;, expectedResult, result);</span>
<span class="fc" id="L251">    }</span>

    @Test
    public void testConstructor_Int_ByteArray_Boolean_UrlSafe() {
        // url-safe variation
<span class="fc" id="L256">        final Base64 base64 = new Base64(64, new byte[]{'\t'}, true);</span>
<span class="fc" id="L257">        final byte[] encoded = base64.encode(Base64TestData.DECODED);</span>
<span class="fc" id="L258">        String expectedResult = Base64TestData.ENCODED_64_CHARS_PER_LINE;</span>
<span class="fc" id="L259">        expectedResult = expectedResult.replaceAll(&quot;=&quot;, &quot;&quot;); // url-safe has no == padding.</span>
<span class="fc" id="L260">        expectedResult = expectedResult.replace('\n', '\t');</span>
<span class="fc" id="L261">        expectedResult = expectedResult.replace('+', '-');</span>
<span class="fc" id="L262">        expectedResult = expectedResult.replace('/', '_');</span>
<span class="fc" id="L263">        final String result = StringUtils.newStringUtf8(encoded);</span>
<span class="fc" id="L264">        assertEquals(&quot;new Base64(64, \\t, true)&quot;, result, expectedResult);</span>
<span class="fc" id="L265">    }</span>

    /**
     * Tests conditional true branch for &quot;marker0&quot; test.
     */
    @Test
    public void testDecodePadMarkerIndex2() {
<span class="fc" id="L272">        assertEquals(&quot;A&quot;, new String(Base64.decodeBase64(&quot;QQ==&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L273">    }</span>

    /**
     * Tests conditional branches for &quot;marker1&quot; test.
     */
    @Test
    public void testDecodePadMarkerIndex3() {
<span class="fc" id="L280">        assertEquals(&quot;AA&quot;, new String(Base64.decodeBase64(&quot;QUE=&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L281">        assertEquals(&quot;AAA&quot;, new String(Base64.decodeBase64(&quot;QUFB&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L282">    }</span>

    @Test
    public void testDecodePadOnly() {
<span class="fc" id="L286">        assertEquals(0, Base64.decodeBase64(&quot;====&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L287">        assertEquals(&quot;&quot;, new String(Base64.decodeBase64(&quot;====&quot;.getBytes(Charsets.UTF_8))));</span>
        // Test truncated padding
<span class="fc" id="L289">        assertEquals(0, Base64.decodeBase64(&quot;===&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L290">        assertEquals(0, Base64.decodeBase64(&quot;==&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L291">        assertEquals(0, Base64.decodeBase64(&quot;=&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L292">        assertEquals(0, Base64.decodeBase64(&quot;&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L293">    }</span>

    @Test
    public void testDecodePadOnlyChunked() {
<span class="fc" id="L297">        assertEquals(0, Base64.decodeBase64(&quot;====\n&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L298">        assertEquals(&quot;&quot;, new String(Base64.decodeBase64(&quot;====\n&quot;.getBytes(Charsets.UTF_8))));</span>
        // Test truncated padding
<span class="fc" id="L300">        assertEquals(0, Base64.decodeBase64(&quot;===\n&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L301">        assertEquals(0, Base64.decodeBase64(&quot;==\n&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L302">        assertEquals(0, Base64.decodeBase64(&quot;=\n&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L303">        assertEquals(0, Base64.decodeBase64(&quot;\n&quot;.getBytes(Charsets.UTF_8)).length);</span>
<span class="fc" id="L304">    }</span>

    @Test
    public void testDecodeWithWhitespace() throws Exception {

<span class="fc" id="L309">        final String orig = &quot;I am a late night coder.&quot;;</span>

<span class="fc" id="L311">        final byte[] encodedArray = Base64.encodeBase64(orig.getBytes(Charsets.UTF_8));</span>
<span class="fc" id="L312">        final StringBuilder intermediate = new StringBuilder(new String(encodedArray));</span>

<span class="fc" id="L314">        intermediate.insert(2, ' ');</span>
<span class="fc" id="L315">        intermediate.insert(5, '\t');</span>
<span class="fc" id="L316">        intermediate.insert(10, '\r');</span>
<span class="fc" id="L317">        intermediate.insert(15, '\n');</span>

<span class="fc" id="L319">        final byte[] encodedWithWS = intermediate.toString().getBytes(Charsets.UTF_8);</span>
<span class="fc" id="L320">        final byte[] decodedWithWS = Base64.decodeBase64(encodedWithWS);</span>

<span class="fc" id="L322">        final String dest = new String(decodedWithWS);</span>

<span class="fc" id="L324">        assertEquals(&quot;Dest string doesn't equal the original&quot;, orig, dest);</span>
<span class="fc" id="L325">    }</span>

    /**
     * Test encode and decode of empty byte array.
     */
    @Test
    public void testEmptyBase64() {
<span class="fc" id="L332">        byte[] empty = new byte[0];</span>
<span class="fc" id="L333">        byte[] result = Base64.encodeBase64(empty);</span>
<span class="fc" id="L334">        assertEquals(&quot;empty base64 encode&quot;, 0, result.length);</span>
<span class="fc" id="L335">        assertEquals(&quot;empty base64 encode&quot;, null, Base64.encodeBase64(null));</span>

<span class="fc" id="L337">        empty = new byte[0];</span>
<span class="fc" id="L338">        result = Base64.decodeBase64(empty);</span>
<span class="fc" id="L339">        assertEquals(&quot;empty base64 decode&quot;, 0, result.length);</span>
<span class="fc" id="L340">        assertEquals(&quot;empty base64 encode&quot;, null, Base64.decodeBase64((byte[]) null));</span>
<span class="fc" id="L341">    }</span>

    // encode/decode a large random array
    @Test
    public void testEncodeDecodeRandom() {
<span class="fc bfc" id="L346" title="All 2 branches covered.">        for (int i = 1; i &lt; 5; i++) {</span>
<span class="fc" id="L347">            final byte[] data = new byte[this.getRandom().nextInt(10000) + 1];</span>
<span class="fc" id="L348">            this.getRandom().nextBytes(data);</span>
<span class="fc" id="L349">            final byte[] enc = Base64.encodeBase64(data);</span>
<span class="fc" id="L350">            assertTrue(Base64.isBase64(enc));</span>
<span class="fc" id="L351">            final byte[] data2 = Base64.decodeBase64(enc);</span>
<span class="fc" id="L352">            assertTrue(Arrays.equals(data, data2));</span>
        }
<span class="fc" id="L354">    }</span>

    // encode/decode random arrays from size 0 to size 11
    @Test
    public void testEncodeDecodeSmall() {
<span class="fc bfc" id="L359" title="All 2 branches covered.">        for (int i = 0; i &lt; 12; i++) {</span>
<span class="fc" id="L360">            final byte[] data = new byte[i];</span>
<span class="fc" id="L361">            this.getRandom().nextBytes(data);</span>
<span class="fc" id="L362">            final byte[] enc = Base64.encodeBase64(data);</span>
<span class="fc" id="L363">            assertTrue(&quot;\&quot;&quot; + new String(enc) + &quot;\&quot; is Base64 data.&quot;, Base64.isBase64(enc));</span>
<span class="fc" id="L364">            final byte[] data2 = Base64.decodeBase64(enc);</span>
<span class="fc" id="L365">            assertTrue(toString(data) + &quot; equals &quot; + toString(data2), Arrays.equals(data, data2));</span>
        }
<span class="fc" id="L367">    }</span>

    @Test
    public void testEncodeOverMaxSize() throws Exception {
<span class="fc" id="L371">        testEncodeOverMaxSize(-1);</span>
<span class="fc" id="L372">        testEncodeOverMaxSize(0);</span>
<span class="fc" id="L373">        testEncodeOverMaxSize(1);</span>
<span class="fc" id="L374">        testEncodeOverMaxSize(2);</span>
<span class="fc" id="L375">    }</span>

    @Test
    public void testCodec112() { // size calculation assumes always chunked
<span class="fc" id="L379">        final byte[] in = new byte[] {0};</span>
<span class="fc" id="L380">        final byte[] out=Base64.encodeBase64(in);</span>
<span class="fc" id="L381">        Base64.encodeBase64(in, false, false, out.length);</span>
<span class="fc" id="L382">    }</span>

    private void testEncodeOverMaxSize(final int maxSize) throws Exception {
        try {
<span class="nc" id="L386">            Base64.encodeBase64(Base64TestData.DECODED, true, false, maxSize);</span>
<span class="nc" id="L387">            fail(&quot;Expected &quot; + IllegalArgumentException.class.getName());</span>
<span class="fc" id="L388">        } catch (final IllegalArgumentException e) {</span>
            // Expected
<span class="nc" id="L390">        }</span>
<span class="fc" id="L391">    }</span>

    @Test
    public void testIgnoringNonBase64InDecode() throws Exception {
<span class="fc" id="L395">        assertEquals(&quot;The quick brown fox jumped over the lazy dogs.&quot;, new String(Base64</span>
<span class="fc" id="L396">                .decodeBase64(&quot;VGhlIH@$#$@%F1aWN@#@#@@rIGJyb3duIGZve\n\r\t%#%#%#%CBqd##$#$W1wZWQgb3ZlciB0aGUgbGF6eSBkb2dzLg==&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L397">    }</span>

    @Test
    public void testIsArrayByteBase64() {
<span class="fc" id="L401">        assertFalse(Base64.isBase64(new byte[]{Byte.MIN_VALUE}));</span>
<span class="fc" id="L402">        assertFalse(Base64.isBase64(new byte[]{-125}));</span>
<span class="fc" id="L403">        assertFalse(Base64.isBase64(new byte[]{-10}));</span>
<span class="fc" id="L404">        assertFalse(Base64.isBase64(new byte[]{0}));</span>
<span class="fc" id="L405">        assertFalse(Base64.isBase64(new byte[]{64, Byte.MAX_VALUE}));</span>
<span class="fc" id="L406">        assertFalse(Base64.isBase64(new byte[]{Byte.MAX_VALUE}));</span>
<span class="fc" id="L407">        assertTrue(Base64.isBase64(new byte[]{'A'}));</span>
<span class="fc" id="L408">        assertFalse(Base64.isBase64(new byte[]{'A', Byte.MIN_VALUE}));</span>
<span class="fc" id="L409">        assertTrue(Base64.isBase64(new byte[]{'A', 'Z', 'a'}));</span>
<span class="fc" id="L410">        assertTrue(Base64.isBase64(new byte[]{'/', '=', '+'}));</span>
<span class="fc" id="L411">        assertFalse(Base64.isBase64(new byte[]{'$'}));</span>
<span class="fc" id="L412">    }</span>

    /**
     * Tests isUrlSafe.
     */
    @Test
    public void testIsUrlSafe() {
<span class="fc" id="L419">        final Base64 base64Standard = new Base64(false);</span>
<span class="fc" id="L420">        final Base64 base64URLSafe = new Base64(true);</span>

<span class="fc" id="L422">        assertFalse(&quot;Base64.isUrlSafe=false&quot;, base64Standard.isUrlSafe());</span>
<span class="fc" id="L423">        assertTrue(&quot;Base64.isUrlSafe=true&quot;, base64URLSafe.isUrlSafe());</span>

<span class="fc" id="L425">        final byte[] whiteSpace = {' ', '\n', '\r', '\t'};</span>
<span class="fc" id="L426">        assertTrue(&quot;Base64.isBase64(whiteSpace)=true&quot;, Base64.isBase64(whiteSpace));</span>
<span class="fc" id="L427">    }</span>

    @Test
    public void testKnownDecodings() {
<span class="fc" id="L431">        assertEquals(&quot;The quick brown fox jumped over the lazy dogs.&quot;, new String(Base64</span>
<span class="fc" id="L432">                .decodeBase64(&quot;VGhlIHF1aWNrIGJyb3duIGZveCBqdW1wZWQgb3ZlciB0aGUgbGF6eSBkb2dzLg==&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L433">        assertEquals(&quot;It was the best of times, it was the worst of times.&quot;, new String(Base64</span>
<span class="fc" id="L434">                .decodeBase64(&quot;SXQgd2FzIHRoZSBiZXN0IG9mIHRpbWVzLCBpdCB3YXMgdGhlIHdvcnN0IG9mIHRpbWVzLg==&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L435">        assertEquals(&quot;http://jakarta.apache.org/commmons&quot;, new String(Base64</span>
<span class="fc" id="L436">                .decodeBase64(&quot;aHR0cDovL2pha2FydGEuYXBhY2hlLm9yZy9jb21tbW9ucw==&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L437">        assertEquals(&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz&quot;, new String(Base64</span>
<span class="fc" id="L438">                .decodeBase64(&quot;QWFCYkNjRGRFZUZmR2dIaElpSmpLa0xsTW1Obk9vUHBRcVJyU3NUdFV1VnZXd1h4WXlaeg==&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L439">        assertEquals(&quot;{ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }&quot;, new String(Base64.decodeBase64(&quot;eyAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5IH0=&quot;</span>
<span class="fc" id="L440">                .getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L441">        assertEquals(&quot;xyzzy!&quot;, new String(Base64.decodeBase64(&quot;eHl6enkh&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L442">    }</span>

    @Test
    public void testKnownEncodings() {
<span class="fc" id="L446">        assertEquals(&quot;VGhlIHF1aWNrIGJyb3duIGZveCBqdW1wZWQgb3ZlciB0aGUgbGF6eSBkb2dzLg==&quot;, new String(Base64</span>
<span class="fc" id="L447">                .encodeBase64(&quot;The quick brown fox jumped over the lazy dogs.&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L448">        assertEquals(</span>
                &quot;YmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJs\r\nYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFo\r\nIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBibGFoIGJsYWggYmxhaCBi\r\nbGFoIGJsYWg=\r\n&quot;,
                new String(
                        Base64
<span class="fc" id="L452">                                .encodeBase64Chunked(&quot;blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah&quot;</span>
<span class="fc" id="L453">                                        .getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L454">        assertEquals(&quot;SXQgd2FzIHRoZSBiZXN0IG9mIHRpbWVzLCBpdCB3YXMgdGhlIHdvcnN0IG9mIHRpbWVzLg==&quot;, new String(Base64</span>
<span class="fc" id="L455">                .encodeBase64(&quot;It was the best of times, it was the worst of times.&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L456">        assertEquals(&quot;aHR0cDovL2pha2FydGEuYXBhY2hlLm9yZy9jb21tbW9ucw==&quot;, new String(Base64</span>
<span class="fc" id="L457">                .encodeBase64(&quot;http://jakarta.apache.org/commmons&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L458">        assertEquals(&quot;QWFCYkNjRGRFZUZmR2dIaElpSmpLa0xsTW1Obk9vUHBRcVJyU3NUdFV1VnZXd1h4WXlaeg==&quot;, new String(Base64</span>
<span class="fc" id="L459">                .encodeBase64(&quot;AaBbCcDdEeFfGgHhIiJjKkLlMmNnOoPpQqRrSsTtUuVvWwXxYyZz&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L460">        assertEquals(&quot;eyAwLCAxLCAyLCAzLCA0LCA1LCA2LCA3LCA4LCA5IH0=&quot;, new String(Base64.encodeBase64(&quot;{ 0, 1, 2, 3, 4, 5, 6, 7, 8, 9 }&quot;</span>
<span class="fc" id="L461">                .getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L462">        assertEquals(&quot;eHl6enkh&quot;, new String(Base64.encodeBase64(&quot;xyzzy!&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L463">    }</span>

    @Test
    public void testNonBase64Test() throws Exception {

<span class="fc" id="L468">        final byte[] bArray = {'%'};</span>

<span class="fc" id="L470">        assertFalse(&quot;Invalid Base64 array was incorrectly validated as &quot; + &quot;an array of Base64 encoded data&quot;, Base64</span>
<span class="fc" id="L471">                .isBase64(bArray));</span>

        try {
<span class="fc" id="L474">            final Base64 b64 = new Base64();</span>
<span class="fc" id="L475">            final byte[] result = b64.decode(bArray);</span>

<span class="fc" id="L477">            assertEquals(&quot;The result should be empty as the test encoded content did &quot; + &quot;not contain any valid base 64 characters&quot;,</span>
                    0, result.length);
<span class="nc" id="L479">        } catch (final Exception e) {</span>
<span class="nc" id="L480">            fail(&quot;Exception was thrown when trying to decode &quot;</span>
                + &quot;invalid base64 encoded data - RFC 2045 requires that all &quot;
                + &quot;non base64 character be discarded, an exception should not&quot;
                + &quot; have been thrown&quot;);
<span class="fc" id="L484">        }</span>
<span class="fc" id="L485">    }</span>

    @Test
    public void testObjectDecodeWithInvalidParameter() throws Exception {
<span class="fc" id="L489">        final Base64 b64 = new Base64();</span>

        try {
<span class="nc" id="L492">            b64.decode(Integer.valueOf(5));</span>
<span class="nc" id="L493">            fail(&quot;decode(Object) didn't throw an exception when passed an Integer object&quot;);</span>
<span class="fc" id="L494">        } catch (final DecoderException e) {</span>
            // ignored
<span class="nc" id="L496">        }</span>

<span class="fc" id="L498">    }</span>

    @Test
    public void testObjectDecodeWithValidParameter() throws Exception {

<span class="fc" id="L503">        final String original = &quot;Hello World!&quot;;</span>
<span class="fc" id="L504">        final Object o = Base64.encodeBase64(original.getBytes(Charsets.UTF_8));</span>

<span class="fc" id="L506">        final Base64 b64 = new Base64();</span>
<span class="fc" id="L507">        final Object oDecoded = b64.decode(o);</span>
<span class="fc" id="L508">        final byte[] baDecoded = (byte[]) oDecoded;</span>
<span class="fc" id="L509">        final String dest = new String(baDecoded);</span>

<span class="fc" id="L511">        assertEquals(&quot;dest string does not equal original&quot;, original, dest);</span>
<span class="fc" id="L512">    }</span>

    @Test
    public void testObjectEncodeWithInvalidParameter() throws Exception {
<span class="fc" id="L516">        final Base64 b64 = new Base64();</span>
        try {
<span class="nc" id="L518">            b64.encode(&quot;Yadayadayada&quot;);</span>
<span class="nc" id="L519">            fail(&quot;encode(Object) didn't throw an exception when passed a String object&quot;);</span>
<span class="fc" id="L520">        } catch (final EncoderException e) {</span>
            // Expected
<span class="nc" id="L522">        }</span>
<span class="fc" id="L523">    }</span>

    @Test
    public void testObjectEncodeWithValidParameter() throws Exception {

<span class="fc" id="L528">        final String original = &quot;Hello World!&quot;;</span>
<span class="fc" id="L529">        final Object origObj = original.getBytes(Charsets.UTF_8);</span>

<span class="fc" id="L531">        final Base64 b64 = new Base64();</span>
<span class="fc" id="L532">        final Object oEncoded = b64.encode(origObj);</span>
<span class="fc" id="L533">        final byte[] bArray = Base64.decodeBase64((byte[]) oEncoded);</span>
<span class="fc" id="L534">        final String dest = new String(bArray);</span>

<span class="fc" id="L536">        assertEquals(&quot;dest string does not equal original&quot;, original, dest);</span>
<span class="fc" id="L537">    }</span>

    @Test
    public void testObjectEncode() throws Exception {
<span class="fc" id="L541">        final Base64 b64 = new Base64();</span>
<span class="fc" id="L542">        assertEquals(&quot;SGVsbG8gV29ybGQ=&quot;, new String(b64.encode(&quot;Hello World&quot;.getBytes(Charsets.UTF_8))));</span>
<span class="fc" id="L543">    }</span>

    @Test
    public void testPairs() {
<span class="fc" id="L547">        assertEquals(&quot;AAA=&quot;, new String(Base64.encodeBase64(new byte[]{0, 0})));</span>
<span class="fc bfc" id="L548" title="All 2 branches covered.">        for (int i = -128; i &lt;= 127; i++) {</span>
<span class="fc" id="L549">            final byte test[] = {(byte) i, (byte) i};</span>
<span class="fc" id="L550">            assertTrue(Arrays.equals(test, Base64.decodeBase64(Base64.encodeBase64(test))));</span>
        }
<span class="fc" id="L552">    }</span>

    /**
     * Tests RFC 2045 section 2.1 CRLF definition.
     */
    @Test
    public void testRfc2045Section2Dot1CrLfDefinition() {
<span class="fc" id="L559">        assertTrue(Arrays.equals(new byte[]{13, 10}, Base64.CHUNK_SEPARATOR));</span>
<span class="fc" id="L560">    }</span>

    /**
     * Tests RFC 2045 section 6.8 chuck size definition.
     */
    @Test
    public void testRfc2045Section6Dot8ChunkSizeDefinition() {
<span class="fc" id="L567">        assertEquals(76, BaseNCodec.MIME_CHUNK_SIZE);</span>
<span class="fc" id="L568">    }</span>

    /**
     * Tests RFC 1421 section 4.3.2.4 chuck size definition.
     */
    @Test
    public void testRfc1421Section6Dot8ChunkSizeDefinition() {
<span class="fc" id="L575">        assertEquals(64, BaseNCodec.PEM_CHUNK_SIZE);</span>
<span class="fc" id="L576">    }</span>

    /**
     * Tests RFC 4648 section 10 test vectors.
     * &lt;ul&gt;
     * &lt;li&gt;BASE64(&quot;&quot;) = &quot;&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;f&quot;) = &quot;Zg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fo&quot;) = &quot;Zm8=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foo&quot;) = &quot;Zm9v&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foob&quot;) = &quot;Zm9vYg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fooba&quot;) = &quot;Zm9vYmE=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foobar&quot;) = &quot;Zm9vYmFy&quot;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @see &lt;a href=&quot;http://tools.ietf.org/html/rfc4648&quot;&gt;http://tools.ietf.org/html/rfc4648&lt;/a&gt;
     */
    @Test
    public void testRfc4648Section10Decode() {
<span class="fc" id="L594">        assertEquals(&quot;&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;&quot;)));</span>
<span class="fc" id="L595">        assertEquals(&quot;f&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zg==&quot;)));</span>
<span class="fc" id="L596">        assertEquals(&quot;fo&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm8=&quot;)));</span>
<span class="fc" id="L597">        assertEquals(&quot;foo&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9v&quot;)));</span>
<span class="fc" id="L598">        assertEquals(&quot;foob&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9vYg==&quot;)));</span>
<span class="fc" id="L599">        assertEquals(&quot;fooba&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9vYmE=&quot;)));</span>
<span class="fc" id="L600">        assertEquals(&quot;foobar&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9vYmFy&quot;)));</span>
<span class="fc" id="L601">    }</span>

    /**
     * Tests RFC 4648 section 10 test vectors.
     * &lt;ul&gt;
     * &lt;li&gt;BASE64(&quot;&quot;) = &quot;&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;f&quot;) = &quot;Zg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fo&quot;) = &quot;Zm8=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foo&quot;) = &quot;Zm9v&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foob&quot;) = &quot;Zm9vYg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fooba&quot;) = &quot;Zm9vYmE=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foobar&quot;) = &quot;Zm9vYmFy&quot;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @see &lt;a href=&quot;http://tools.ietf.org/html/rfc4648&quot;&gt;http://tools.ietf.org/html/rfc4648&lt;/a&gt;
     */
    @Test
    public void testRfc4648Section10DecodeWithCrLf() {
<span class="fc" id="L619">        final String CRLF = StringUtils.newStringUsAscii(Base64.CHUNK_SEPARATOR);</span>
<span class="fc" id="L620">        assertEquals(&quot;&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;&quot; + CRLF)));</span>
<span class="fc" id="L621">        assertEquals(&quot;f&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zg==&quot; + CRLF)));</span>
<span class="fc" id="L622">        assertEquals(&quot;fo&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm8=&quot; + CRLF)));</span>
<span class="fc" id="L623">        assertEquals(&quot;foo&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9v&quot; + CRLF)));</span>
<span class="fc" id="L624">        assertEquals(&quot;foob&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9vYg==&quot; + CRLF)));</span>
<span class="fc" id="L625">        assertEquals(&quot;fooba&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9vYmE=&quot; + CRLF)));</span>
<span class="fc" id="L626">        assertEquals(&quot;foobar&quot;, StringUtils.newStringUsAscii(Base64.decodeBase64(&quot;Zm9vYmFy&quot; + CRLF)));</span>
<span class="fc" id="L627">    }</span>

    /**
     * Tests RFC 4648 section 10 test vectors.
     * &lt;ul&gt;
     * &lt;li&gt;BASE64(&quot;&quot;) = &quot;&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;f&quot;) = &quot;Zg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fo&quot;) = &quot;Zm8=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foo&quot;) = &quot;Zm9v&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foob&quot;) = &quot;Zm9vYg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fooba&quot;) = &quot;Zm9vYmE=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foobar&quot;) = &quot;Zm9vYmFy&quot;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @see &lt;a href=&quot;http://tools.ietf.org/html/rfc4648&quot;&gt;http://tools.ietf.org/html/rfc4648&lt;/a&gt;
     */
    @Test
    public void testRfc4648Section10Encode() {
<span class="fc" id="L645">        assertEquals(&quot;&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;&quot;)));</span>
<span class="fc" id="L646">        assertEquals(&quot;Zg==&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;f&quot;)));</span>
<span class="fc" id="L647">        assertEquals(&quot;Zm8=&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;fo&quot;)));</span>
<span class="fc" id="L648">        assertEquals(&quot;Zm9v&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;foo&quot;)));</span>
<span class="fc" id="L649">        assertEquals(&quot;Zm9vYg==&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;foob&quot;)));</span>
<span class="fc" id="L650">        assertEquals(&quot;Zm9vYmE=&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;fooba&quot;)));</span>
<span class="fc" id="L651">        assertEquals(&quot;Zm9vYmFy&quot;, Base64.encodeBase64String(StringUtils.getBytesUtf8(&quot;foobar&quot;)));</span>
<span class="fc" id="L652">    }</span>

    /**
     * Tests RFC 4648 section 10 test vectors.
     * &lt;ul&gt;
     * &lt;li&gt;BASE64(&quot;&quot;) = &quot;&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;f&quot;) = &quot;Zg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fo&quot;) = &quot;Zm8=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foo&quot;) = &quot;Zm9v&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foob&quot;) = &quot;Zm9vYg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fooba&quot;) = &quot;Zm9vYmE=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foobar&quot;) = &quot;Zm9vYmFy&quot;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @see &lt;a href=&quot;http://tools.ietf.org/html/rfc4648&quot;&gt;http://tools.ietf.org/html/rfc4648&lt;/a&gt;
     */
    @Test
    public void testRfc4648Section10DecodeEncode() {
<span class="fc" id="L670">        testDecodeEncode(&quot;&quot;);</span>
<span class="fc" id="L671">        testDecodeEncode(&quot;Zg==&quot;);</span>
<span class="fc" id="L672">        testDecodeEncode(&quot;Zm8=&quot;);</span>
<span class="fc" id="L673">        testDecodeEncode(&quot;Zm9v&quot;);</span>
<span class="fc" id="L674">        testDecodeEncode(&quot;Zm9vYg==&quot;);</span>
<span class="fc" id="L675">        testDecodeEncode(&quot;Zm9vYmE=&quot;);</span>
<span class="fc" id="L676">        testDecodeEncode(&quot;Zm9vYmFy&quot;);</span>
<span class="fc" id="L677">    }</span>

    private void testDecodeEncode(final String encodedText) {
<span class="fc" id="L680">        final String decodedText = StringUtils.newStringUsAscii(Base64.decodeBase64(encodedText));</span>
<span class="fc" id="L681">        final String encodedText2 = Base64.encodeBase64String(StringUtils.getBytesUtf8(decodedText));</span>
<span class="fc" id="L682">        assertEquals(encodedText, encodedText2);</span>
<span class="fc" id="L683">    }</span>

    /**
     * Tests RFC 4648 section 10 test vectors.
     * &lt;ul&gt;
     * &lt;li&gt;BASE64(&quot;&quot;) = &quot;&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;f&quot;) = &quot;Zg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fo&quot;) = &quot;Zm8=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foo&quot;) = &quot;Zm9v&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foob&quot;) = &quot;Zm9vYg==&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;fooba&quot;) = &quot;Zm9vYmE=&quot;&lt;/li&gt;
     * &lt;li&gt;BASE64(&quot;foobar&quot;) = &quot;Zm9vYmFy&quot;&lt;/li&gt;
     * &lt;/ul&gt;
     *
     * @see &lt;a href=&quot;http://tools.ietf.org/html/rfc4648&quot;&gt;http://tools.ietf.org/html/rfc4648&lt;/a&gt;
     */
    @Test
    public void testRfc4648Section10EncodeDecode() {
<span class="fc" id="L701">        testEncodeDecode(&quot;&quot;);</span>
<span class="fc" id="L702">        testEncodeDecode(&quot;f&quot;);</span>
<span class="fc" id="L703">        testEncodeDecode(&quot;fo&quot;);</span>
<span class="fc" id="L704">        testEncodeDecode(&quot;foo&quot;);</span>
<span class="fc" id="L705">        testEncodeDecode(&quot;foob&quot;);</span>
<span class="fc" id="L706">        testEncodeDecode(&quot;fooba&quot;);</span>
<span class="fc" id="L707">        testEncodeDecode(&quot;foobar&quot;);</span>
<span class="fc" id="L708">    }</span>

    private void testEncodeDecode(final String plainText) {
<span class="fc" id="L711">        final String encodedText = Base64.encodeBase64String(StringUtils.getBytesUtf8(plainText));</span>
<span class="fc" id="L712">        final String decodedText = StringUtils.newStringUsAscii(Base64.decodeBase64(encodedText));</span>
<span class="fc" id="L713">        assertEquals(plainText, decodedText);</span>
<span class="fc" id="L714">    }</span>

    @Test
    public void testSingletons() {
<span class="fc" id="L718">        assertEquals(&quot;AA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0})));</span>
<span class="fc" id="L719">        assertEquals(&quot;AQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 1})));</span>
<span class="fc" id="L720">        assertEquals(&quot;Ag==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 2})));</span>
<span class="fc" id="L721">        assertEquals(&quot;Aw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 3})));</span>
<span class="fc" id="L722">        assertEquals(&quot;BA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 4})));</span>
<span class="fc" id="L723">        assertEquals(&quot;BQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 5})));</span>
<span class="fc" id="L724">        assertEquals(&quot;Bg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 6})));</span>
<span class="fc" id="L725">        assertEquals(&quot;Bw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 7})));</span>
<span class="fc" id="L726">        assertEquals(&quot;CA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 8})));</span>
<span class="fc" id="L727">        assertEquals(&quot;CQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 9})));</span>
<span class="fc" id="L728">        assertEquals(&quot;Cg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 10})));</span>
<span class="fc" id="L729">        assertEquals(&quot;Cw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 11})));</span>
<span class="fc" id="L730">        assertEquals(&quot;DA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 12})));</span>
<span class="fc" id="L731">        assertEquals(&quot;DQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 13})));</span>
<span class="fc" id="L732">        assertEquals(&quot;Dg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 14})));</span>
<span class="fc" id="L733">        assertEquals(&quot;Dw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 15})));</span>
<span class="fc" id="L734">        assertEquals(&quot;EA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 16})));</span>
<span class="fc" id="L735">        assertEquals(&quot;EQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 17})));</span>
<span class="fc" id="L736">        assertEquals(&quot;Eg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 18})));</span>
<span class="fc" id="L737">        assertEquals(&quot;Ew==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 19})));</span>
<span class="fc" id="L738">        assertEquals(&quot;FA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 20})));</span>
<span class="fc" id="L739">        assertEquals(&quot;FQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 21})));</span>
<span class="fc" id="L740">        assertEquals(&quot;Fg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 22})));</span>
<span class="fc" id="L741">        assertEquals(&quot;Fw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 23})));</span>
<span class="fc" id="L742">        assertEquals(&quot;GA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 24})));</span>
<span class="fc" id="L743">        assertEquals(&quot;GQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 25})));</span>
<span class="fc" id="L744">        assertEquals(&quot;Gg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 26})));</span>
<span class="fc" id="L745">        assertEquals(&quot;Gw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 27})));</span>
<span class="fc" id="L746">        assertEquals(&quot;HA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 28})));</span>
<span class="fc" id="L747">        assertEquals(&quot;HQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 29})));</span>
<span class="fc" id="L748">        assertEquals(&quot;Hg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 30})));</span>
<span class="fc" id="L749">        assertEquals(&quot;Hw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 31})));</span>
<span class="fc" id="L750">        assertEquals(&quot;IA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 32})));</span>
<span class="fc" id="L751">        assertEquals(&quot;IQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 33})));</span>
<span class="fc" id="L752">        assertEquals(&quot;Ig==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 34})));</span>
<span class="fc" id="L753">        assertEquals(&quot;Iw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 35})));</span>
<span class="fc" id="L754">        assertEquals(&quot;JA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 36})));</span>
<span class="fc" id="L755">        assertEquals(&quot;JQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 37})));</span>
<span class="fc" id="L756">        assertEquals(&quot;Jg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 38})));</span>
<span class="fc" id="L757">        assertEquals(&quot;Jw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 39})));</span>
<span class="fc" id="L758">        assertEquals(&quot;KA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 40})));</span>
<span class="fc" id="L759">        assertEquals(&quot;KQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 41})));</span>
<span class="fc" id="L760">        assertEquals(&quot;Kg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 42})));</span>
<span class="fc" id="L761">        assertEquals(&quot;Kw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 43})));</span>
<span class="fc" id="L762">        assertEquals(&quot;LA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 44})));</span>
<span class="fc" id="L763">        assertEquals(&quot;LQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 45})));</span>
<span class="fc" id="L764">        assertEquals(&quot;Lg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 46})));</span>
<span class="fc" id="L765">        assertEquals(&quot;Lw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 47})));</span>
<span class="fc" id="L766">        assertEquals(&quot;MA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 48})));</span>
<span class="fc" id="L767">        assertEquals(&quot;MQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 49})));</span>
<span class="fc" id="L768">        assertEquals(&quot;Mg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 50})));</span>
<span class="fc" id="L769">        assertEquals(&quot;Mw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 51})));</span>
<span class="fc" id="L770">        assertEquals(&quot;NA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 52})));</span>
<span class="fc" id="L771">        assertEquals(&quot;NQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 53})));</span>
<span class="fc" id="L772">        assertEquals(&quot;Ng==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 54})));</span>
<span class="fc" id="L773">        assertEquals(&quot;Nw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 55})));</span>
<span class="fc" id="L774">        assertEquals(&quot;OA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 56})));</span>
<span class="fc" id="L775">        assertEquals(&quot;OQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 57})));</span>
<span class="fc" id="L776">        assertEquals(&quot;Og==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 58})));</span>
<span class="fc" id="L777">        assertEquals(&quot;Ow==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 59})));</span>
<span class="fc" id="L778">        assertEquals(&quot;PA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 60})));</span>
<span class="fc" id="L779">        assertEquals(&quot;PQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 61})));</span>
<span class="fc" id="L780">        assertEquals(&quot;Pg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 62})));</span>
<span class="fc" id="L781">        assertEquals(&quot;Pw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 63})));</span>
<span class="fc" id="L782">        assertEquals(&quot;QA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 64})));</span>
<span class="fc" id="L783">        assertEquals(&quot;QQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 65})));</span>
<span class="fc" id="L784">        assertEquals(&quot;Qg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 66})));</span>
<span class="fc" id="L785">        assertEquals(&quot;Qw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 67})));</span>
<span class="fc" id="L786">        assertEquals(&quot;RA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 68})));</span>
<span class="fc" id="L787">        assertEquals(&quot;RQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 69})));</span>
<span class="fc" id="L788">        assertEquals(&quot;Rg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 70})));</span>
<span class="fc" id="L789">        assertEquals(&quot;Rw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 71})));</span>
<span class="fc" id="L790">        assertEquals(&quot;SA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 72})));</span>
<span class="fc" id="L791">        assertEquals(&quot;SQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 73})));</span>
<span class="fc" id="L792">        assertEquals(&quot;Sg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 74})));</span>
<span class="fc" id="L793">        assertEquals(&quot;Sw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 75})));</span>
<span class="fc" id="L794">        assertEquals(&quot;TA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 76})));</span>
<span class="fc" id="L795">        assertEquals(&quot;TQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 77})));</span>
<span class="fc" id="L796">        assertEquals(&quot;Tg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 78})));</span>
<span class="fc" id="L797">        assertEquals(&quot;Tw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 79})));</span>
<span class="fc" id="L798">        assertEquals(&quot;UA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 80})));</span>
<span class="fc" id="L799">        assertEquals(&quot;UQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 81})));</span>
<span class="fc" id="L800">        assertEquals(&quot;Ug==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 82})));</span>
<span class="fc" id="L801">        assertEquals(&quot;Uw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 83})));</span>
<span class="fc" id="L802">        assertEquals(&quot;VA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 84})));</span>
<span class="fc" id="L803">        assertEquals(&quot;VQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 85})));</span>
<span class="fc" id="L804">        assertEquals(&quot;Vg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 86})));</span>
<span class="fc" id="L805">        assertEquals(&quot;Vw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 87})));</span>
<span class="fc" id="L806">        assertEquals(&quot;WA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 88})));</span>
<span class="fc" id="L807">        assertEquals(&quot;WQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 89})));</span>
<span class="fc" id="L808">        assertEquals(&quot;Wg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 90})));</span>
<span class="fc" id="L809">        assertEquals(&quot;Ww==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 91})));</span>
<span class="fc" id="L810">        assertEquals(&quot;XA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 92})));</span>
<span class="fc" id="L811">        assertEquals(&quot;XQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 93})));</span>
<span class="fc" id="L812">        assertEquals(&quot;Xg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 94})));</span>
<span class="fc" id="L813">        assertEquals(&quot;Xw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 95})));</span>
<span class="fc" id="L814">        assertEquals(&quot;YA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 96})));</span>
<span class="fc" id="L815">        assertEquals(&quot;YQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 97})));</span>
<span class="fc" id="L816">        assertEquals(&quot;Yg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 98})));</span>
<span class="fc" id="L817">        assertEquals(&quot;Yw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 99})));</span>
<span class="fc" id="L818">        assertEquals(&quot;ZA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 100})));</span>
<span class="fc" id="L819">        assertEquals(&quot;ZQ==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 101})));</span>
<span class="fc" id="L820">        assertEquals(&quot;Zg==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 102})));</span>
<span class="fc" id="L821">        assertEquals(&quot;Zw==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 103})));</span>
<span class="fc" id="L822">        assertEquals(&quot;aA==&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 104})));</span>
<span class="fc bfc" id="L823" title="All 2 branches covered.">        for (int i = -128; i &lt;= 127; i++) {</span>
<span class="fc" id="L824">            final byte test[] = {(byte) i};</span>
<span class="fc" id="L825">            assertTrue(Arrays.equals(test, Base64.decodeBase64(Base64.encodeBase64(test))));</span>
        }
<span class="fc" id="L827">    }</span>

    @Test
    public void testSingletonsChunked() {
<span class="fc" id="L831">        assertEquals(&quot;AA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0})));</span>
<span class="fc" id="L832">        assertEquals(&quot;AQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 1})));</span>
<span class="fc" id="L833">        assertEquals(&quot;Ag==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 2})));</span>
<span class="fc" id="L834">        assertEquals(&quot;Aw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 3})));</span>
<span class="fc" id="L835">        assertEquals(&quot;BA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 4})));</span>
<span class="fc" id="L836">        assertEquals(&quot;BQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 5})));</span>
<span class="fc" id="L837">        assertEquals(&quot;Bg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 6})));</span>
<span class="fc" id="L838">        assertEquals(&quot;Bw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 7})));</span>
<span class="fc" id="L839">        assertEquals(&quot;CA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 8})));</span>
<span class="fc" id="L840">        assertEquals(&quot;CQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 9})));</span>
<span class="fc" id="L841">        assertEquals(&quot;Cg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 10})));</span>
<span class="fc" id="L842">        assertEquals(&quot;Cw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 11})));</span>
<span class="fc" id="L843">        assertEquals(&quot;DA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 12})));</span>
<span class="fc" id="L844">        assertEquals(&quot;DQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 13})));</span>
<span class="fc" id="L845">        assertEquals(&quot;Dg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 14})));</span>
<span class="fc" id="L846">        assertEquals(&quot;Dw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 15})));</span>
<span class="fc" id="L847">        assertEquals(&quot;EA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 16})));</span>
<span class="fc" id="L848">        assertEquals(&quot;EQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 17})));</span>
<span class="fc" id="L849">        assertEquals(&quot;Eg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 18})));</span>
<span class="fc" id="L850">        assertEquals(&quot;Ew==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 19})));</span>
<span class="fc" id="L851">        assertEquals(&quot;FA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 20})));</span>
<span class="fc" id="L852">        assertEquals(&quot;FQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 21})));</span>
<span class="fc" id="L853">        assertEquals(&quot;Fg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 22})));</span>
<span class="fc" id="L854">        assertEquals(&quot;Fw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 23})));</span>
<span class="fc" id="L855">        assertEquals(&quot;GA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 24})));</span>
<span class="fc" id="L856">        assertEquals(&quot;GQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 25})));</span>
<span class="fc" id="L857">        assertEquals(&quot;Gg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 26})));</span>
<span class="fc" id="L858">        assertEquals(&quot;Gw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 27})));</span>
<span class="fc" id="L859">        assertEquals(&quot;HA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 28})));</span>
<span class="fc" id="L860">        assertEquals(&quot;HQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 29})));</span>
<span class="fc" id="L861">        assertEquals(&quot;Hg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 30})));</span>
<span class="fc" id="L862">        assertEquals(&quot;Hw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 31})));</span>
<span class="fc" id="L863">        assertEquals(&quot;IA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 32})));</span>
<span class="fc" id="L864">        assertEquals(&quot;IQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 33})));</span>
<span class="fc" id="L865">        assertEquals(&quot;Ig==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 34})));</span>
<span class="fc" id="L866">        assertEquals(&quot;Iw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 35})));</span>
<span class="fc" id="L867">        assertEquals(&quot;JA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 36})));</span>
<span class="fc" id="L868">        assertEquals(&quot;JQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 37})));</span>
<span class="fc" id="L869">        assertEquals(&quot;Jg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 38})));</span>
<span class="fc" id="L870">        assertEquals(&quot;Jw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 39})));</span>
<span class="fc" id="L871">        assertEquals(&quot;KA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 40})));</span>
<span class="fc" id="L872">        assertEquals(&quot;KQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 41})));</span>
<span class="fc" id="L873">        assertEquals(&quot;Kg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 42})));</span>
<span class="fc" id="L874">        assertEquals(&quot;Kw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 43})));</span>
<span class="fc" id="L875">        assertEquals(&quot;LA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 44})));</span>
<span class="fc" id="L876">        assertEquals(&quot;LQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 45})));</span>
<span class="fc" id="L877">        assertEquals(&quot;Lg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 46})));</span>
<span class="fc" id="L878">        assertEquals(&quot;Lw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 47})));</span>
<span class="fc" id="L879">        assertEquals(&quot;MA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 48})));</span>
<span class="fc" id="L880">        assertEquals(&quot;MQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 49})));</span>
<span class="fc" id="L881">        assertEquals(&quot;Mg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 50})));</span>
<span class="fc" id="L882">        assertEquals(&quot;Mw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 51})));</span>
<span class="fc" id="L883">        assertEquals(&quot;NA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 52})));</span>
<span class="fc" id="L884">        assertEquals(&quot;NQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 53})));</span>
<span class="fc" id="L885">        assertEquals(&quot;Ng==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 54})));</span>
<span class="fc" id="L886">        assertEquals(&quot;Nw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 55})));</span>
<span class="fc" id="L887">        assertEquals(&quot;OA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 56})));</span>
<span class="fc" id="L888">        assertEquals(&quot;OQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 57})));</span>
<span class="fc" id="L889">        assertEquals(&quot;Og==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 58})));</span>
<span class="fc" id="L890">        assertEquals(&quot;Ow==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 59})));</span>
<span class="fc" id="L891">        assertEquals(&quot;PA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 60})));</span>
<span class="fc" id="L892">        assertEquals(&quot;PQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 61})));</span>
<span class="fc" id="L893">        assertEquals(&quot;Pg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 62})));</span>
<span class="fc" id="L894">        assertEquals(&quot;Pw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 63})));</span>
<span class="fc" id="L895">        assertEquals(&quot;QA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 64})));</span>
<span class="fc" id="L896">        assertEquals(&quot;QQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 65})));</span>
<span class="fc" id="L897">        assertEquals(&quot;Qg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 66})));</span>
<span class="fc" id="L898">        assertEquals(&quot;Qw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 67})));</span>
<span class="fc" id="L899">        assertEquals(&quot;RA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 68})));</span>
<span class="fc" id="L900">        assertEquals(&quot;RQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 69})));</span>
<span class="fc" id="L901">        assertEquals(&quot;Rg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 70})));</span>
<span class="fc" id="L902">        assertEquals(&quot;Rw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 71})));</span>
<span class="fc" id="L903">        assertEquals(&quot;SA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 72})));</span>
<span class="fc" id="L904">        assertEquals(&quot;SQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 73})));</span>
<span class="fc" id="L905">        assertEquals(&quot;Sg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 74})));</span>
<span class="fc" id="L906">        assertEquals(&quot;Sw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 75})));</span>
<span class="fc" id="L907">        assertEquals(&quot;TA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 76})));</span>
<span class="fc" id="L908">        assertEquals(&quot;TQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 77})));</span>
<span class="fc" id="L909">        assertEquals(&quot;Tg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 78})));</span>
<span class="fc" id="L910">        assertEquals(&quot;Tw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 79})));</span>
<span class="fc" id="L911">        assertEquals(&quot;UA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 80})));</span>
<span class="fc" id="L912">        assertEquals(&quot;UQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 81})));</span>
<span class="fc" id="L913">        assertEquals(&quot;Ug==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 82})));</span>
<span class="fc" id="L914">        assertEquals(&quot;Uw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 83})));</span>
<span class="fc" id="L915">        assertEquals(&quot;VA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 84})));</span>
<span class="fc" id="L916">        assertEquals(&quot;VQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 85})));</span>
<span class="fc" id="L917">        assertEquals(&quot;Vg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 86})));</span>
<span class="fc" id="L918">        assertEquals(&quot;Vw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 87})));</span>
<span class="fc" id="L919">        assertEquals(&quot;WA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 88})));</span>
<span class="fc" id="L920">        assertEquals(&quot;WQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 89})));</span>
<span class="fc" id="L921">        assertEquals(&quot;Wg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 90})));</span>
<span class="fc" id="L922">        assertEquals(&quot;Ww==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 91})));</span>
<span class="fc" id="L923">        assertEquals(&quot;XA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 92})));</span>
<span class="fc" id="L924">        assertEquals(&quot;XQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 93})));</span>
<span class="fc" id="L925">        assertEquals(&quot;Xg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 94})));</span>
<span class="fc" id="L926">        assertEquals(&quot;Xw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 95})));</span>
<span class="fc" id="L927">        assertEquals(&quot;YA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 96})));</span>
<span class="fc" id="L928">        assertEquals(&quot;YQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 97})));</span>
<span class="fc" id="L929">        assertEquals(&quot;Yg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 98})));</span>
<span class="fc" id="L930">        assertEquals(&quot;Yw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 99})));</span>
<span class="fc" id="L931">        assertEquals(&quot;ZA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 100})));</span>
<span class="fc" id="L932">        assertEquals(&quot;ZQ==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 101})));</span>
<span class="fc" id="L933">        assertEquals(&quot;Zg==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 102})));</span>
<span class="fc" id="L934">        assertEquals(&quot;Zw==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 103})));</span>
<span class="fc" id="L935">        assertEquals(&quot;aA==\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 104})));</span>
<span class="fc" id="L936">    }</span>

    @Test
    public void testTriplets() {
<span class="fc" id="L940">        assertEquals(&quot;AAAA&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 0})));</span>
<span class="fc" id="L941">        assertEquals(&quot;AAAB&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 1})));</span>
<span class="fc" id="L942">        assertEquals(&quot;AAAC&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 2})));</span>
<span class="fc" id="L943">        assertEquals(&quot;AAAD&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 3})));</span>
<span class="fc" id="L944">        assertEquals(&quot;AAAE&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 4})));</span>
<span class="fc" id="L945">        assertEquals(&quot;AAAF&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 5})));</span>
<span class="fc" id="L946">        assertEquals(&quot;AAAG&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 6})));</span>
<span class="fc" id="L947">        assertEquals(&quot;AAAH&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 7})));</span>
<span class="fc" id="L948">        assertEquals(&quot;AAAI&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 8})));</span>
<span class="fc" id="L949">        assertEquals(&quot;AAAJ&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 9})));</span>
<span class="fc" id="L950">        assertEquals(&quot;AAAK&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 10})));</span>
<span class="fc" id="L951">        assertEquals(&quot;AAAL&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 11})));</span>
<span class="fc" id="L952">        assertEquals(&quot;AAAM&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 12})));</span>
<span class="fc" id="L953">        assertEquals(&quot;AAAN&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 13})));</span>
<span class="fc" id="L954">        assertEquals(&quot;AAAO&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 14})));</span>
<span class="fc" id="L955">        assertEquals(&quot;AAAP&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 15})));</span>
<span class="fc" id="L956">        assertEquals(&quot;AAAQ&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 16})));</span>
<span class="fc" id="L957">        assertEquals(&quot;AAAR&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 17})));</span>
<span class="fc" id="L958">        assertEquals(&quot;AAAS&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 18})));</span>
<span class="fc" id="L959">        assertEquals(&quot;AAAT&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 19})));</span>
<span class="fc" id="L960">        assertEquals(&quot;AAAU&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 20})));</span>
<span class="fc" id="L961">        assertEquals(&quot;AAAV&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 21})));</span>
<span class="fc" id="L962">        assertEquals(&quot;AAAW&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 22})));</span>
<span class="fc" id="L963">        assertEquals(&quot;AAAX&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 23})));</span>
<span class="fc" id="L964">        assertEquals(&quot;AAAY&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 24})));</span>
<span class="fc" id="L965">        assertEquals(&quot;AAAZ&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 25})));</span>
<span class="fc" id="L966">        assertEquals(&quot;AAAa&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 26})));</span>
<span class="fc" id="L967">        assertEquals(&quot;AAAb&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 27})));</span>
<span class="fc" id="L968">        assertEquals(&quot;AAAc&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 28})));</span>
<span class="fc" id="L969">        assertEquals(&quot;AAAd&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 29})));</span>
<span class="fc" id="L970">        assertEquals(&quot;AAAe&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 30})));</span>
<span class="fc" id="L971">        assertEquals(&quot;AAAf&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 31})));</span>
<span class="fc" id="L972">        assertEquals(&quot;AAAg&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 32})));</span>
<span class="fc" id="L973">        assertEquals(&quot;AAAh&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 33})));</span>
<span class="fc" id="L974">        assertEquals(&quot;AAAi&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 34})));</span>
<span class="fc" id="L975">        assertEquals(&quot;AAAj&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 35})));</span>
<span class="fc" id="L976">        assertEquals(&quot;AAAk&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 36})));</span>
<span class="fc" id="L977">        assertEquals(&quot;AAAl&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 37})));</span>
<span class="fc" id="L978">        assertEquals(&quot;AAAm&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 38})));</span>
<span class="fc" id="L979">        assertEquals(&quot;AAAn&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 39})));</span>
<span class="fc" id="L980">        assertEquals(&quot;AAAo&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 40})));</span>
<span class="fc" id="L981">        assertEquals(&quot;AAAp&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 41})));</span>
<span class="fc" id="L982">        assertEquals(&quot;AAAq&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 42})));</span>
<span class="fc" id="L983">        assertEquals(&quot;AAAr&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 43})));</span>
<span class="fc" id="L984">        assertEquals(&quot;AAAs&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 44})));</span>
<span class="fc" id="L985">        assertEquals(&quot;AAAt&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 45})));</span>
<span class="fc" id="L986">        assertEquals(&quot;AAAu&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 46})));</span>
<span class="fc" id="L987">        assertEquals(&quot;AAAv&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 47})));</span>
<span class="fc" id="L988">        assertEquals(&quot;AAAw&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 48})));</span>
<span class="fc" id="L989">        assertEquals(&quot;AAAx&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 49})));</span>
<span class="fc" id="L990">        assertEquals(&quot;AAAy&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 50})));</span>
<span class="fc" id="L991">        assertEquals(&quot;AAAz&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 51})));</span>
<span class="fc" id="L992">        assertEquals(&quot;AAA0&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 52})));</span>
<span class="fc" id="L993">        assertEquals(&quot;AAA1&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 53})));</span>
<span class="fc" id="L994">        assertEquals(&quot;AAA2&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 54})));</span>
<span class="fc" id="L995">        assertEquals(&quot;AAA3&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 55})));</span>
<span class="fc" id="L996">        assertEquals(&quot;AAA4&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 56})));</span>
<span class="fc" id="L997">        assertEquals(&quot;AAA5&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 57})));</span>
<span class="fc" id="L998">        assertEquals(&quot;AAA6&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 58})));</span>
<span class="fc" id="L999">        assertEquals(&quot;AAA7&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 59})));</span>
<span class="fc" id="L1000">        assertEquals(&quot;AAA8&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 60})));</span>
<span class="fc" id="L1001">        assertEquals(&quot;AAA9&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 61})));</span>
<span class="fc" id="L1002">        assertEquals(&quot;AAA+&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 62})));</span>
<span class="fc" id="L1003">        assertEquals(&quot;AAA/&quot;, new String(Base64.encodeBase64(new byte[]{(byte) 0, (byte) 0, (byte) 63})));</span>
<span class="fc" id="L1004">    }</span>

    @Test
    public void testTripletsChunked() {
<span class="fc" id="L1008">        assertEquals(&quot;AAAA\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 0})));</span>
<span class="fc" id="L1009">        assertEquals(&quot;AAAB\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 1})));</span>
<span class="fc" id="L1010">        assertEquals(&quot;AAAC\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 2})));</span>
<span class="fc" id="L1011">        assertEquals(&quot;AAAD\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 3})));</span>
<span class="fc" id="L1012">        assertEquals(&quot;AAAE\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 4})));</span>
<span class="fc" id="L1013">        assertEquals(&quot;AAAF\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 5})));</span>
<span class="fc" id="L1014">        assertEquals(&quot;AAAG\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 6})));</span>
<span class="fc" id="L1015">        assertEquals(&quot;AAAH\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 7})));</span>
<span class="fc" id="L1016">        assertEquals(&quot;AAAI\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 8})));</span>
<span class="fc" id="L1017">        assertEquals(&quot;AAAJ\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 9})));</span>
<span class="fc" id="L1018">        assertEquals(&quot;AAAK\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 10})));</span>
<span class="fc" id="L1019">        assertEquals(&quot;AAAL\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 11})));</span>
<span class="fc" id="L1020">        assertEquals(&quot;AAAM\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 12})));</span>
<span class="fc" id="L1021">        assertEquals(&quot;AAAN\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 13})));</span>
<span class="fc" id="L1022">        assertEquals(&quot;AAAO\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 14})));</span>
<span class="fc" id="L1023">        assertEquals(&quot;AAAP\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 15})));</span>
<span class="fc" id="L1024">        assertEquals(&quot;AAAQ\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 16})));</span>
<span class="fc" id="L1025">        assertEquals(&quot;AAAR\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 17})));</span>
<span class="fc" id="L1026">        assertEquals(&quot;AAAS\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 18})));</span>
<span class="fc" id="L1027">        assertEquals(&quot;AAAT\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 19})));</span>
<span class="fc" id="L1028">        assertEquals(&quot;AAAU\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 20})));</span>
<span class="fc" id="L1029">        assertEquals(&quot;AAAV\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 21})));</span>
<span class="fc" id="L1030">        assertEquals(&quot;AAAW\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 22})));</span>
<span class="fc" id="L1031">        assertEquals(&quot;AAAX\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 23})));</span>
<span class="fc" id="L1032">        assertEquals(&quot;AAAY\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 24})));</span>
<span class="fc" id="L1033">        assertEquals(&quot;AAAZ\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 25})));</span>
<span class="fc" id="L1034">        assertEquals(&quot;AAAa\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 26})));</span>
<span class="fc" id="L1035">        assertEquals(&quot;AAAb\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 27})));</span>
<span class="fc" id="L1036">        assertEquals(&quot;AAAc\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 28})));</span>
<span class="fc" id="L1037">        assertEquals(&quot;AAAd\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 29})));</span>
<span class="fc" id="L1038">        assertEquals(&quot;AAAe\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 30})));</span>
<span class="fc" id="L1039">        assertEquals(&quot;AAAf\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 31})));</span>
<span class="fc" id="L1040">        assertEquals(&quot;AAAg\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 32})));</span>
<span class="fc" id="L1041">        assertEquals(&quot;AAAh\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 33})));</span>
<span class="fc" id="L1042">        assertEquals(&quot;AAAi\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 34})));</span>
<span class="fc" id="L1043">        assertEquals(&quot;AAAj\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 35})));</span>
<span class="fc" id="L1044">        assertEquals(&quot;AAAk\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 36})));</span>
<span class="fc" id="L1045">        assertEquals(&quot;AAAl\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 37})));</span>
<span class="fc" id="L1046">        assertEquals(&quot;AAAm\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 38})));</span>
<span class="fc" id="L1047">        assertEquals(&quot;AAAn\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 39})));</span>
<span class="fc" id="L1048">        assertEquals(&quot;AAAo\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 40})));</span>
<span class="fc" id="L1049">        assertEquals(&quot;AAAp\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 41})));</span>
<span class="fc" id="L1050">        assertEquals(&quot;AAAq\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 42})));</span>
<span class="fc" id="L1051">        assertEquals(&quot;AAAr\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 43})));</span>
<span class="fc" id="L1052">        assertEquals(&quot;AAAs\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 44})));</span>
<span class="fc" id="L1053">        assertEquals(&quot;AAAt\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 45})));</span>
<span class="fc" id="L1054">        assertEquals(&quot;AAAu\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 46})));</span>
<span class="fc" id="L1055">        assertEquals(&quot;AAAv\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 47})));</span>
<span class="fc" id="L1056">        assertEquals(&quot;AAAw\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 48})));</span>
<span class="fc" id="L1057">        assertEquals(&quot;AAAx\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 49})));</span>
<span class="fc" id="L1058">        assertEquals(&quot;AAAy\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 50})));</span>
<span class="fc" id="L1059">        assertEquals(&quot;AAAz\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 51})));</span>
<span class="fc" id="L1060">        assertEquals(&quot;AAA0\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 52})));</span>
<span class="fc" id="L1061">        assertEquals(&quot;AAA1\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 53})));</span>
<span class="fc" id="L1062">        assertEquals(&quot;AAA2\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 54})));</span>
<span class="fc" id="L1063">        assertEquals(&quot;AAA3\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 55})));</span>
<span class="fc" id="L1064">        assertEquals(&quot;AAA4\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 56})));</span>
<span class="fc" id="L1065">        assertEquals(&quot;AAA5\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 57})));</span>
<span class="fc" id="L1066">        assertEquals(&quot;AAA6\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 58})));</span>
<span class="fc" id="L1067">        assertEquals(&quot;AAA7\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 59})));</span>
<span class="fc" id="L1068">        assertEquals(&quot;AAA8\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 60})));</span>
<span class="fc" id="L1069">        assertEquals(&quot;AAA9\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 61})));</span>
<span class="fc" id="L1070">        assertEquals(&quot;AAA+\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 62})));</span>
<span class="fc" id="L1071">        assertEquals(&quot;AAA/\r\n&quot;, new String(Base64.encodeBase64Chunked(new byte[]{(byte) 0, (byte) 0, (byte) 63})));</span>
<span class="fc" id="L1072">    }</span>

    /**
     * Tests url-safe Base64 against random data, sizes 0 to 150.
     */
    @Test
    public void testUrlSafe() {
        // test random data of sizes 0 thru 150
<span class="fc bfc" id="L1080" title="All 2 branches covered.">        for (int i = 0; i &lt;= 150; i++) {</span>
<span class="fc" id="L1081">            final byte[][] randomData = Base64TestData.randomData(i, true);</span>
<span class="fc" id="L1082">            final byte[] encoded = randomData[1];</span>
<span class="fc" id="L1083">            final byte[] decoded = randomData[0];</span>
<span class="fc" id="L1084">            final byte[] result = Base64.decodeBase64(encoded);</span>
<span class="fc" id="L1085">            assertTrue(&quot;url-safe i=&quot; + i, Arrays.equals(decoded, result));</span>
<span class="fc" id="L1086">            assertFalse(&quot;url-safe i=&quot; + i + &quot; no '='&quot;, Base64TestData.bytesContain(encoded, (byte) '='));</span>
<span class="fc" id="L1087">            assertFalse(&quot;url-safe i=&quot; + i + &quot; no '\\'&quot;, Base64TestData.bytesContain(encoded, (byte) '\\'));</span>
<span class="fc" id="L1088">            assertFalse(&quot;url-safe i=&quot; + i + &quot; no '+'&quot;, Base64TestData.bytesContain(encoded, (byte) '+'));</span>
        }

<span class="fc" id="L1091">    }</span>

    /**
     * Base64 encoding of UUID's is a common use-case, especially in URL-SAFE mode. This test case ends up being the
     * &quot;URL-SAFE&quot; JUnit's.
     *
     * @throws DecoderException
     *             if Hex.decode() fails - a serious problem since Hex comes from our own commons-codec!
     */
    @Test
    public void testUUID() throws DecoderException {
        // The 4 UUID's below contains mixtures of + and / to help us test the
        // URL-SAFE encoding mode.
<span class="fc" id="L1104">        final byte[][] ids = new byte[4][];</span>

        // ids[0] was chosen so that it encodes with at least one +.
<span class="fc" id="L1107">        ids[0] = Hex.decodeHex(&quot;94ed8d0319e4493399560fb67404d370&quot;.toCharArray());</span>

        // ids[1] was chosen so that it encodes with both / and +.
<span class="fc" id="L1110">        ids[1] = Hex.decodeHex(&quot;2bf7cc2701fe4397b49ebeed5acc7090&quot;.toCharArray());</span>

        // ids[2] was chosen so that it encodes with at least one /.
<span class="fc" id="L1113">        ids[2] = Hex.decodeHex(&quot;64be154b6ffa40258d1a01288e7c31ca&quot;.toCharArray());</span>

        // ids[3] was chosen so that it encodes with both / and +, with /
        // right at the beginning.
<span class="fc" id="L1117">        ids[3] = Hex.decodeHex(&quot;ff7f8fc01cdb471a8c8b5a9306183fe8&quot;.toCharArray());</span>

<span class="fc" id="L1119">        final byte[][] standard = new byte[4][];</span>
<span class="fc" id="L1120">        standard[0] = StringUtils.getBytesUtf8(&quot;lO2NAxnkSTOZVg+2dATTcA==&quot;);</span>
<span class="fc" id="L1121">        standard[1] = StringUtils.getBytesUtf8(&quot;K/fMJwH+Q5e0nr7tWsxwkA==&quot;);</span>
<span class="fc" id="L1122">        standard[2] = StringUtils.getBytesUtf8(&quot;ZL4VS2/6QCWNGgEojnwxyg==&quot;);</span>
<span class="fc" id="L1123">        standard[3] = StringUtils.getBytesUtf8(&quot;/3+PwBzbRxqMi1qTBhg/6A==&quot;);</span>

<span class="fc" id="L1125">        final byte[][] urlSafe1 = new byte[4][];</span>
        // regular padding (two '==' signs).
<span class="fc" id="L1127">        urlSafe1[0] = StringUtils.getBytesUtf8(&quot;lO2NAxnkSTOZVg-2dATTcA==&quot;);</span>
<span class="fc" id="L1128">        urlSafe1[1] = StringUtils.getBytesUtf8(&quot;K_fMJwH-Q5e0nr7tWsxwkA==&quot;);</span>
<span class="fc" id="L1129">        urlSafe1[2] = StringUtils.getBytesUtf8(&quot;ZL4VS2_6QCWNGgEojnwxyg==&quot;);</span>
<span class="fc" id="L1130">        urlSafe1[3] = StringUtils.getBytesUtf8(&quot;_3-PwBzbRxqMi1qTBhg_6A==&quot;);</span>

<span class="fc" id="L1132">        final byte[][] urlSafe2 = new byte[4][];</span>
        // single padding (only one '=' sign).
<span class="fc" id="L1134">        urlSafe2[0] = StringUtils.getBytesUtf8(&quot;lO2NAxnkSTOZVg-2dATTcA=&quot;);</span>
<span class="fc" id="L1135">        urlSafe2[1] = StringUtils.getBytesUtf8(&quot;K_fMJwH-Q5e0nr7tWsxwkA=&quot;);</span>
<span class="fc" id="L1136">        urlSafe2[2] = StringUtils.getBytesUtf8(&quot;ZL4VS2_6QCWNGgEojnwxyg=&quot;);</span>
<span class="fc" id="L1137">        urlSafe2[3] = StringUtils.getBytesUtf8(&quot;_3-PwBzbRxqMi1qTBhg_6A=&quot;);</span>

<span class="fc" id="L1139">        final byte[][] urlSafe3 = new byte[4][];</span>
        // no padding (no '=' signs).
<span class="fc" id="L1141">        urlSafe3[0] = StringUtils.getBytesUtf8(&quot;lO2NAxnkSTOZVg-2dATTcA&quot;);</span>
<span class="fc" id="L1142">        urlSafe3[1] = StringUtils.getBytesUtf8(&quot;K_fMJwH-Q5e0nr7tWsxwkA&quot;);</span>
<span class="fc" id="L1143">        urlSafe3[2] = StringUtils.getBytesUtf8(&quot;ZL4VS2_6QCWNGgEojnwxyg&quot;);</span>
<span class="fc" id="L1144">        urlSafe3[3] = StringUtils.getBytesUtf8(&quot;_3-PwBzbRxqMi1qTBhg_6A&quot;);</span>

<span class="fc bfc" id="L1146" title="All 2 branches covered.">        for (int i = 0; i &lt; 4; i++) {</span>
<span class="fc" id="L1147">            final byte[] encodedStandard = Base64.encodeBase64(ids[i]);</span>
<span class="fc" id="L1148">            final byte[] encodedUrlSafe = Base64.encodeBase64URLSafe(ids[i]);</span>
<span class="fc" id="L1149">            final byte[] decodedStandard = Base64.decodeBase64(standard[i]);</span>
<span class="fc" id="L1150">            final byte[] decodedUrlSafe1 = Base64.decodeBase64(urlSafe1[i]);</span>
<span class="fc" id="L1151">            final byte[] decodedUrlSafe2 = Base64.decodeBase64(urlSafe2[i]);</span>
<span class="fc" id="L1152">            final byte[] decodedUrlSafe3 = Base64.decodeBase64(urlSafe3[i]);</span>

            // Very important debugging output should anyone
            // ever need to delve closely into this stuff.
            if (false) {
                System.out.println(&quot;reference: [&quot; + Hex.encodeHexString(ids[i]) + &quot;]&quot;);
                System.out.println(&quot;standard:  [&quot; +
                        Hex.encodeHexString(decodedStandard) +
                    &quot;] From: [&quot; +
                    StringUtils.newStringUtf8(standard[i]) +
                    &quot;]&quot;);
                System.out.println(&quot;safe1:     [&quot; +
                        Hex.encodeHexString(decodedUrlSafe1) +
                    &quot;] From: [&quot; +
                    StringUtils.newStringUtf8(urlSafe1[i]) +
                    &quot;]&quot;);
                System.out.println(&quot;safe2:     [&quot; +
                        Hex.encodeHexString(decodedUrlSafe2) +
                    &quot;] From: [&quot; +
                    StringUtils.newStringUtf8(urlSafe2[i]) +
                    &quot;]&quot;);
                System.out.println(&quot;safe3:     [&quot; +
                        Hex.encodeHexString(decodedUrlSafe3) +
                    &quot;] From: [&quot; +
                    StringUtils.newStringUtf8(urlSafe3[i]) +
                    &quot;]&quot;);
            }

<span class="fc" id="L1180">            assertTrue(&quot;standard encode uuid&quot;, Arrays.equals(encodedStandard, standard[i]));</span>
<span class="fc" id="L1181">            assertTrue(&quot;url-safe encode uuid&quot;, Arrays.equals(encodedUrlSafe, urlSafe3[i]));</span>
<span class="fc" id="L1182">            assertTrue(&quot;standard decode uuid&quot;, Arrays.equals(decodedStandard, ids[i]));</span>
<span class="fc" id="L1183">            assertTrue(&quot;url-safe1 decode uuid&quot;, Arrays.equals(decodedUrlSafe1, ids[i]));</span>
<span class="fc" id="L1184">            assertTrue(&quot;url-safe2 decode uuid&quot;, Arrays.equals(decodedUrlSafe2, ids[i]));</span>
<span class="fc" id="L1185">            assertTrue(&quot;url-safe3 decode uuid&quot;, Arrays.equals(decodedUrlSafe3, ids[i]));</span>
        }
<span class="fc" id="L1187">    }</span>

    @Test
    public void testByteToStringVariations() throws DecoderException {
<span class="fc" id="L1191">        final Base64 base64 = new Base64(0);</span>
<span class="fc" id="L1192">        final byte[] b1 = StringUtils.getBytesUtf8(&quot;Hello World&quot;);</span>
<span class="fc" id="L1193">        final byte[] b2 = new byte[0];</span>
<span class="fc" id="L1194">        final byte[] b3 = null;</span>
<span class="fc" id="L1195">        final byte[] b4 = Hex.decodeHex(&quot;2bf7cc2701fe4397b49ebeed5acc7090&quot;.toCharArray());  // for url-safe tests</span>

<span class="fc" id="L1197">        assertEquals(&quot;byteToString Hello World&quot;, &quot;SGVsbG8gV29ybGQ=&quot;, base64.encodeToString(b1));</span>
<span class="fc" id="L1198">        assertEquals(&quot;byteToString static Hello World&quot;, &quot;SGVsbG8gV29ybGQ=&quot;, Base64.encodeBase64String(b1));</span>
<span class="fc" id="L1199">        assertEquals(&quot;byteToString \&quot;\&quot;&quot;, &quot;&quot;, base64.encodeToString(b2));</span>
<span class="fc" id="L1200">        assertEquals(&quot;byteToString static \&quot;\&quot;&quot;, &quot;&quot;, Base64.encodeBase64String(b2));</span>
<span class="fc" id="L1201">        assertEquals(&quot;byteToString null&quot;, null, base64.encodeToString(b3));</span>
<span class="fc" id="L1202">        assertEquals(&quot;byteToString static null&quot;, null, Base64.encodeBase64String(b3));</span>
<span class="fc" id="L1203">        assertEquals(&quot;byteToString UUID&quot;, &quot;K/fMJwH+Q5e0nr7tWsxwkA==&quot;, base64.encodeToString(b4));</span>
<span class="fc" id="L1204">        assertEquals(&quot;byteToString static UUID&quot;, &quot;K/fMJwH+Q5e0nr7tWsxwkA==&quot;, Base64.encodeBase64String(b4));</span>
<span class="fc" id="L1205">        assertEquals(&quot;byteToString static-url-safe UUID&quot;, &quot;K_fMJwH-Q5e0nr7tWsxwkA&quot;, Base64.encodeBase64URLSafeString(b4));</span>
<span class="fc" id="L1206">    }</span>

    @Test
    public void testStringToByteVariations() throws DecoderException {
<span class="fc" id="L1210">        final Base64 base64 = new Base64();</span>
<span class="fc" id="L1211">        final String s1 = &quot;SGVsbG8gV29ybGQ=\r\n&quot;;</span>
<span class="fc" id="L1212">        final String s2 = &quot;&quot;;</span>
<span class="fc" id="L1213">        final String s3 = null;</span>
<span class="fc" id="L1214">        final String s4a = &quot;K/fMJwH+Q5e0nr7tWsxwkA==\r\n&quot;;</span>
<span class="fc" id="L1215">        final String s4b = &quot;K_fMJwH-Q5e0nr7tWsxwkA&quot;;</span>
<span class="fc" id="L1216">        final byte[] b4 = Hex.decodeHex(&quot;2bf7cc2701fe4397b49ebeed5acc7090&quot;.toCharArray());  // for url-safe tests</span>

<span class="fc" id="L1218">        assertEquals(&quot;StringToByte Hello World&quot;, &quot;Hello World&quot;, StringUtils.newStringUtf8(base64.decode(s1)));</span>
<span class="fc" id="L1219">        assertEquals(&quot;StringToByte Hello World&quot;, &quot;Hello World&quot;, StringUtils.newStringUtf8((byte[])base64.decode((Object)s1)));</span>
<span class="fc" id="L1220">        assertEquals(&quot;StringToByte static Hello World&quot;, &quot;Hello World&quot;, StringUtils.newStringUtf8(Base64.decodeBase64(s1)));</span>
<span class="fc" id="L1221">        assertEquals(&quot;StringToByte \&quot;\&quot;&quot;, &quot;&quot;, StringUtils.newStringUtf8(base64.decode(s2)));</span>
<span class="fc" id="L1222">        assertEquals(&quot;StringToByte static \&quot;\&quot;&quot;, &quot;&quot;, StringUtils.newStringUtf8(Base64.decodeBase64(s2)));</span>
<span class="fc" id="L1223">        assertEquals(&quot;StringToByte null&quot;, null, StringUtils.newStringUtf8(base64.decode(s3)));</span>
<span class="fc" id="L1224">        assertEquals(&quot;StringToByte static null&quot;, null, StringUtils.newStringUtf8(Base64.decodeBase64(s3)));</span>
<span class="fc" id="L1225">        assertTrue(&quot;StringToByte UUID&quot;, Arrays.equals(b4, base64.decode(s4b)));</span>
<span class="fc" id="L1226">        assertTrue(&quot;StringToByte static UUID&quot;, Arrays.equals(b4, Base64.decodeBase64(s4a)));</span>
<span class="fc" id="L1227">        assertTrue(&quot;StringToByte static-url-safe UUID&quot;, Arrays.equals(b4, Base64.decodeBase64(s4b)));</span>
<span class="fc" id="L1228">    }</span>

    private String toString(final byte[] data) {
<span class="fc" id="L1231">        final StringBuilder buf = new StringBuilder();</span>
<span class="fc bfc" id="L1232" title="All 2 branches covered.">        for (int i = 0; i &lt; data.length; i++) {</span>
<span class="fc" id="L1233">            buf.append(data[i]);</span>
<span class="fc bfc" id="L1234" title="All 2 branches covered.">            if (i != data.length - 1) {</span>
<span class="fc" id="L1235">                buf.append(&quot;,&quot;);</span>
            }
        }
<span class="fc" id="L1238">        return buf.toString();</span>
    }

    /**
     * Tests a lineSeparator much bigger than DEFAULT_BUFFER_SIZE.
     *
     * @see &quot;&lt;a href='http://mail-archives.apache.org/mod_mbox/commons-dev/201202.mbox/%3C4F3C85D7.5060706@snafu.de%3E'&gt;dev@commons.apache.org&lt;/a&gt;&quot;
     */
    @Test
    @Ignore
    public void testHugeLineSeparator() {
<span class="nc" id="L1249">        final int BaseNCodec_DEFAULT_BUFFER_SIZE = 8192;</span>
<span class="nc" id="L1250">        final int Base64_BYTES_PER_ENCODED_BLOCK = 4;</span>
<span class="nc" id="L1251">        final byte[] baLineSeparator = new byte[BaseNCodec_DEFAULT_BUFFER_SIZE * 4 - 3];</span>
<span class="nc" id="L1252">        final Base64 b64 = new Base64(Base64_BYTES_PER_ENCODED_BLOCK, baLineSeparator);</span>
<span class="nc" id="L1253">        final String strOriginal = &quot;Hello World&quot;;</span>
<span class="nc" id="L1254">        final String strDecoded = new String(b64.decode(b64.encode(StringUtils.getBytesUtf8(strOriginal))));</span>
<span class="nc" id="L1255">        assertEquals(&quot;testDEFAULT_BUFFER_SIZE&quot;, strOriginal, strDecoded);</span>
<span class="nc" id="L1256">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>