<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>BehaviorProcessorTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">RxJava_2_x$Unnamed.exec</a> &gt; <a href="index.source.html" class="el_package">io.reactivex.processors</a> &gt; <span class="el_source">BehaviorProcessorTest.java</span></div><h1>BehaviorProcessorTest.java</h1><pre class="source lang-java linenums">/**
 * Copyright (c) 2016-present, RxJava Contributors.
 *
 * Licensed under the Apache License, Version 2.0 (the &quot;License&quot;); you may not use this file except in
 * compliance with the License. You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software distributed under the License is
 * distributed on an &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See
 * the License for the specific language governing permissions and limitations under the License.
 */

package io.reactivex.processors;

import static org.junit.Assert.*;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.Mockito.*;

import java.util.List;
import java.util.concurrent.*;
import java.util.concurrent.atomic.AtomicReference;

import org.junit.*;
import org.mockito.*;
import org.reactivestreams.Subscriber;

import io.reactivex.*;
import io.reactivex.exceptions.*;
import io.reactivex.functions.Function;
import io.reactivex.internal.subscriptions.BooleanSubscription;
import io.reactivex.plugins.RxJavaPlugins;
import io.reactivex.processors.BehaviorProcessor.BehaviorSubscription;
import io.reactivex.schedulers.Schedulers;
import io.reactivex.subscribers.*;

<span class="fc" id="L37">public class BehaviorProcessorTest extends FlowableProcessorTest&lt;Object&gt; {</span>

<span class="fc" id="L39">    private final Throwable testException = new Throwable();</span>

    @Override
    protected FlowableProcessor&lt;Object&gt; create() {
<span class="fc" id="L43">        return BehaviorProcessor.create();</span>
    }

    @Test
    public void testThatSubscriberReceivesDefaultValueAndSubsequentEvents() {
<span class="fc" id="L48">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>

<span class="fc" id="L50">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L51">        processor.subscribe(subscriber);</span>

<span class="fc" id="L53">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L54">        processor.onNext(&quot;two&quot;);</span>
<span class="fc" id="L55">        processor.onNext(&quot;three&quot;);</span>

<span class="fc" id="L57">        verify(subscriber, times(1)).onNext(&quot;default&quot;);</span>
<span class="fc" id="L58">        verify(subscriber, times(1)).onNext(&quot;one&quot;);</span>
<span class="fc" id="L59">        verify(subscriber, times(1)).onNext(&quot;two&quot;);</span>
<span class="fc" id="L60">        verify(subscriber, times(1)).onNext(&quot;three&quot;);</span>
<span class="fc" id="L61">        verify(subscriber, Mockito.never()).onError(testException);</span>
<span class="fc" id="L62">        verify(subscriber, Mockito.never()).onComplete();</span>
<span class="fc" id="L63">    }</span>

    @Test
    public void testThatSubscriberReceivesLatestAndThenSubsequentEvents() {
<span class="fc" id="L67">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>

<span class="fc" id="L69">        processor.onNext(&quot;one&quot;);</span>

<span class="fc" id="L71">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L72">        processor.subscribe(subscriber);</span>

<span class="fc" id="L74">        processor.onNext(&quot;two&quot;);</span>
<span class="fc" id="L75">        processor.onNext(&quot;three&quot;);</span>

<span class="fc" id="L77">        verify(subscriber, Mockito.never()).onNext(&quot;default&quot;);</span>
<span class="fc" id="L78">        verify(subscriber, times(1)).onNext(&quot;one&quot;);</span>
<span class="fc" id="L79">        verify(subscriber, times(1)).onNext(&quot;two&quot;);</span>
<span class="fc" id="L80">        verify(subscriber, times(1)).onNext(&quot;three&quot;);</span>
<span class="fc" id="L81">        verify(subscriber, Mockito.never()).onError(testException);</span>
<span class="fc" id="L82">        verify(subscriber, Mockito.never()).onComplete();</span>
<span class="fc" id="L83">    }</span>

    @Test
    public void testSubscribeThenOnComplete() {
<span class="fc" id="L87">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>

<span class="fc" id="L89">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L90">        processor.subscribe(subscriber);</span>

<span class="fc" id="L92">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L93">        processor.onComplete();</span>

<span class="fc" id="L95">        verify(subscriber, times(1)).onNext(&quot;default&quot;);</span>
<span class="fc" id="L96">        verify(subscriber, times(1)).onNext(&quot;one&quot;);</span>
<span class="fc" id="L97">        verify(subscriber, Mockito.never()).onError(any(Throwable.class));</span>
<span class="fc" id="L98">        verify(subscriber, times(1)).onComplete();</span>
<span class="fc" id="L99">    }</span>

    @Test
    public void testSubscribeToCompletedOnlyEmitsOnComplete() {
<span class="fc" id="L103">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>
<span class="fc" id="L104">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L105">        processor.onComplete();</span>

<span class="fc" id="L107">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L108">        processor.subscribe(subscriber);</span>

<span class="fc" id="L110">        verify(subscriber, never()).onNext(&quot;default&quot;);</span>
<span class="fc" id="L111">        verify(subscriber, never()).onNext(&quot;one&quot;);</span>
<span class="fc" id="L112">        verify(subscriber, Mockito.never()).onError(any(Throwable.class));</span>
<span class="fc" id="L113">        verify(subscriber, times(1)).onComplete();</span>
<span class="fc" id="L114">    }</span>

    @Test
    public void testSubscribeToErrorOnlyEmitsOnError() {
<span class="fc" id="L118">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>
<span class="fc" id="L119">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L120">        RuntimeException re = new RuntimeException(&quot;test error&quot;);</span>
<span class="fc" id="L121">        processor.onError(re);</span>

<span class="fc" id="L123">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L124">        processor.subscribe(subscriber);</span>

<span class="fc" id="L126">        verify(subscriber, never()).onNext(&quot;default&quot;);</span>
<span class="fc" id="L127">        verify(subscriber, never()).onNext(&quot;one&quot;);</span>
<span class="fc" id="L128">        verify(subscriber, times(1)).onError(re);</span>
<span class="fc" id="L129">        verify(subscriber, never()).onComplete();</span>
<span class="fc" id="L130">    }</span>

    @Test
    public void testCompletedStopsEmittingData() {
<span class="fc" id="L134">        BehaviorProcessor&lt;Integer&gt; channel = BehaviorProcessor.createDefault(2013);</span>
<span class="fc" id="L135">        Subscriber&lt;Object&gt; observerA = TestHelper.mockSubscriber();</span>
<span class="fc" id="L136">        Subscriber&lt;Object&gt; observerB = TestHelper.mockSubscriber();</span>
<span class="fc" id="L137">        Subscriber&lt;Object&gt; observerC = TestHelper.mockSubscriber();</span>

<span class="fc" id="L139">        TestSubscriber&lt;Object&gt; ts = new TestSubscriber&lt;Object&gt;(observerA);</span>

<span class="fc" id="L141">        channel.subscribe(ts);</span>
<span class="fc" id="L142">        channel.subscribe(observerB);</span>

<span class="fc" id="L144">        InOrder inOrderA = inOrder(observerA);</span>
<span class="fc" id="L145">        InOrder inOrderB = inOrder(observerB);</span>
<span class="fc" id="L146">        InOrder inOrderC = inOrder(observerC);</span>

<span class="fc" id="L148">        inOrderA.verify(observerA).onNext(2013);</span>
<span class="fc" id="L149">        inOrderB.verify(observerB).onNext(2013);</span>

<span class="fc" id="L151">        channel.onNext(42);</span>

<span class="fc" id="L153">        inOrderA.verify(observerA).onNext(42);</span>
<span class="fc" id="L154">        inOrderB.verify(observerB).onNext(42);</span>

<span class="fc" id="L156">        ts.dispose();</span>
<span class="fc" id="L157">        inOrderA.verifyNoMoreInteractions();</span>

<span class="fc" id="L159">        channel.onNext(4711);</span>

<span class="fc" id="L161">        inOrderB.verify(observerB).onNext(4711);</span>

<span class="fc" id="L163">        channel.onComplete();</span>

<span class="fc" id="L165">        inOrderB.verify(observerB).onComplete();</span>

<span class="fc" id="L167">        channel.subscribe(observerC);</span>

<span class="fc" id="L169">        inOrderC.verify(observerC).onComplete();</span>

<span class="fc" id="L171">        channel.onNext(13);</span>

<span class="fc" id="L173">        inOrderB.verifyNoMoreInteractions();</span>
<span class="fc" id="L174">        inOrderC.verifyNoMoreInteractions();</span>
<span class="fc" id="L175">    }</span>

    @Test
    public void testCompletedAfterErrorIsNotSent() {
<span class="fc" id="L179">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>

<span class="fc" id="L181">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L182">        processor.subscribe(subscriber);</span>

<span class="fc" id="L184">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L185">        processor.onError(testException);</span>
<span class="fc" id="L186">        processor.onNext(&quot;two&quot;);</span>
<span class="fc" id="L187">        processor.onComplete();</span>

<span class="fc" id="L189">        verify(subscriber, times(1)).onNext(&quot;default&quot;);</span>
<span class="fc" id="L190">        verify(subscriber, times(1)).onNext(&quot;one&quot;);</span>
<span class="fc" id="L191">        verify(subscriber, times(1)).onError(testException);</span>
<span class="fc" id="L192">        verify(subscriber, never()).onNext(&quot;two&quot;);</span>
<span class="fc" id="L193">        verify(subscriber, never()).onComplete();</span>
<span class="fc" id="L194">    }</span>

    @Test
    public void testCompletedAfterErrorIsNotSent2() {
<span class="fc" id="L198">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>

<span class="fc" id="L200">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L201">        processor.subscribe(subscriber);</span>

<span class="fc" id="L203">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L204">        processor.onError(testException);</span>
<span class="fc" id="L205">        processor.onNext(&quot;two&quot;);</span>
<span class="fc" id="L206">        processor.onComplete();</span>

<span class="fc" id="L208">        verify(subscriber, times(1)).onNext(&quot;default&quot;);</span>
<span class="fc" id="L209">        verify(subscriber, times(1)).onNext(&quot;one&quot;);</span>
<span class="fc" id="L210">        verify(subscriber, times(1)).onError(testException);</span>
<span class="fc" id="L211">        verify(subscriber, never()).onNext(&quot;two&quot;);</span>
<span class="fc" id="L212">        verify(subscriber, never()).onComplete();</span>

<span class="fc" id="L214">        Subscriber&lt;Object&gt; subscriber2 = TestHelper.mockSubscriber();</span>
<span class="fc" id="L215">        processor.subscribe(subscriber2);</span>
<span class="fc" id="L216">        verify(subscriber2, times(1)).onError(testException);</span>
<span class="fc" id="L217">        verify(subscriber2, never()).onNext(any());</span>
<span class="fc" id="L218">        verify(subscriber2, never()).onComplete();</span>
<span class="fc" id="L219">    }</span>

    @Test
    public void testCompletedAfterErrorIsNotSent3() {
<span class="fc" id="L223">        BehaviorProcessor&lt;String&gt; processor = BehaviorProcessor.createDefault(&quot;default&quot;);</span>

<span class="fc" id="L225">        Subscriber&lt;String&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L226">        processor.subscribe(subscriber);</span>

<span class="fc" id="L228">        processor.onNext(&quot;one&quot;);</span>
<span class="fc" id="L229">        processor.onComplete();</span>
<span class="fc" id="L230">        processor.onNext(&quot;two&quot;);</span>
<span class="fc" id="L231">        processor.onComplete();</span>

<span class="fc" id="L233">        verify(subscriber, times(1)).onNext(&quot;default&quot;);</span>
<span class="fc" id="L234">        verify(subscriber, times(1)).onNext(&quot;one&quot;);</span>
<span class="fc" id="L235">        verify(subscriber, times(1)).onComplete();</span>
<span class="fc" id="L236">        verify(subscriber, never()).onError(any(Throwable.class));</span>
<span class="fc" id="L237">        verify(subscriber, never()).onNext(&quot;two&quot;);</span>

<span class="fc" id="L239">        Subscriber&lt;Object&gt; subscriber2 = TestHelper.mockSubscriber();</span>
<span class="fc" id="L240">        processor.subscribe(subscriber2);</span>
<span class="fc" id="L241">        verify(subscriber2, times(1)).onComplete();</span>
<span class="fc" id="L242">        verify(subscriber2, never()).onNext(any());</span>
<span class="fc" id="L243">        verify(subscriber, never()).onError(any(Throwable.class));</span>
<span class="fc" id="L244">    }</span>

    @Test(timeout = 1000)
    public void testUnsubscriptionCase() {
<span class="fc" id="L248">        BehaviorProcessor&lt;String&gt; src = BehaviorProcessor.createDefault(&quot;null&quot;); // FIXME was plain null which is not allowed</span>

<span class="fc bfc" id="L250" title="All 2 branches covered.">        for (int i = 0; i &lt; 10; i++) {</span>
<span class="fc" id="L251">            final Subscriber&lt;Object&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L252">            InOrder inOrder = inOrder(subscriber);</span>
<span class="fc" id="L253">            String v = &quot;&quot; + i;</span>
<span class="fc" id="L254">            src.onNext(v);</span>
<span class="fc" id="L255">            System.out.printf(&quot;Turn: %d%n&quot;, i);</span>
<span class="fc" id="L256">            src.firstElement().toFlowable()</span>
<span class="fc" id="L257">                .flatMap(new Function&lt;String, Flowable&lt;String&gt;&gt;() {</span>

                    @Override
                    public Flowable&lt;String&gt; apply(String t1) {
<span class="fc" id="L261">                        return Flowable.just(t1 + &quot;, &quot; + t1);</span>
                    }
                })
<span class="fc" id="L264">                .subscribe(new DefaultSubscriber&lt;String&gt;() {</span>
                    @Override
                    public void onNext(String t) {
<span class="fc" id="L267">                        subscriber.onNext(t);</span>
<span class="fc" id="L268">                    }</span>

                    @Override
                    public void onError(Throwable e) {
<span class="nc" id="L272">                        subscriber.onError(e);</span>
<span class="nc" id="L273">                    }</span>

                    @Override
                    public void onComplete() {
<span class="fc" id="L277">                        subscriber.onComplete();</span>
<span class="fc" id="L278">                    }</span>
                });
<span class="fc" id="L280">            inOrder.verify(subscriber).onNext(v + &quot;, &quot; + v);</span>
<span class="fc" id="L281">            inOrder.verify(subscriber).onComplete();</span>
<span class="fc" id="L282">            verify(subscriber, never()).onError(any(Throwable.class));</span>
        }
<span class="fc" id="L284">    }</span>

    @Test
    public void testStartEmpty() {
<span class="fc" id="L288">        BehaviorProcessor&lt;Integer&gt; source = BehaviorProcessor.create();</span>
<span class="fc" id="L289">        final Subscriber&lt;Object&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L290">        InOrder inOrder = inOrder(subscriber);</span>

<span class="fc" id="L292">        source.subscribe(subscriber);</span>

<span class="fc" id="L294">        inOrder.verify(subscriber, never()).onNext(any());</span>
<span class="fc" id="L295">        inOrder.verify(subscriber, never()).onComplete();</span>

<span class="fc" id="L297">        source.onNext(1);</span>

<span class="fc" id="L299">        source.onComplete();</span>

<span class="fc" id="L301">        source.onNext(2);</span>

<span class="fc" id="L303">        verify(subscriber, never()).onError(any(Throwable.class));</span>

<span class="fc" id="L305">        inOrder.verify(subscriber).onNext(1);</span>
<span class="fc" id="L306">        inOrder.verify(subscriber).onComplete();</span>
<span class="fc" id="L307">        inOrder.verifyNoMoreInteractions();</span>
<span class="fc" id="L308">    }</span>

    @Test
    public void testStartEmptyThenAddOne() {
<span class="fc" id="L312">        BehaviorProcessor&lt;Integer&gt; source = BehaviorProcessor.create();</span>
<span class="fc" id="L313">        final Subscriber&lt;Object&gt; subscriber = TestHelper.mockSubscriber();</span>
<span class="fc" id="L314">        InOrder inOrder = inOrder(subscriber);</span>

<span class="fc" id="L316">        source.onNext(1);</span>

<span class="fc" id="L318">        source.subscribe(subscriber);</span>

<span class="fc" id="L320">        inOrder.verify(subscriber).onNext(1);</span>

<span class="fc" id="L322">        source.onComplete();</span>

<span class="fc" id="L324">        source.onNext(2);</span>

<span class="fc" id="L326">        inOrder.verify(subscriber).onComplete();</span>
<span class="fc" id="L327">        inOrder.verifyNoMoreInteractions();</span>

<span class="fc" id="L329">        verify(subscriber, never()).onError(any(Throwable.class));</span>

<span class="fc" id="L331">    }</span>

    @Test
    public void testStartEmptyCompleteWithOne() {
<span class="fc" id="L335">        BehaviorProcessor&lt;Integer&gt; source = BehaviorProcessor.create();</span>
<span class="fc" id="L336">        final Subscriber&lt;Object&gt; subscriber = TestHelper.mockSubscriber();</span>

<span class="fc" id="L338">        source.onNext(1);</span>
<span class="fc" id="L339">        source.onComplete();</span>

<span class="fc" id="L341">        source.onNext(2);</span>

<span class="fc" id="L343">        source.subscribe(subscriber);</span>

<span class="fc" id="L345">        verify(subscriber).onComplete();</span>
<span class="fc" id="L346">        verify(subscriber, never()).onError(any(Throwable.class));</span>
<span class="fc" id="L347">        verify(subscriber, never()).onNext(any());</span>
<span class="fc" id="L348">    }</span>

    @Test
    public void testTakeOneSubscriber() {
<span class="fc" id="L352">        BehaviorProcessor&lt;Integer&gt; source = BehaviorProcessor.createDefault(1);</span>
<span class="fc" id="L353">        final Subscriber&lt;Object&gt; subscriber = TestHelper.mockSubscriber();</span>

<span class="fc" id="L355">        source.take(1).subscribe(subscriber);</span>

<span class="fc" id="L357">        verify(subscriber).onNext(1);</span>
<span class="fc" id="L358">        verify(subscriber).onComplete();</span>
<span class="fc" id="L359">        verify(subscriber, never()).onError(any(Throwable.class));</span>

<span class="fc" id="L361">        assertEquals(0, source.subscriberCount());</span>
<span class="fc" id="L362">        assertFalse(source.hasSubscribers());</span>
<span class="fc" id="L363">    }</span>

    // FIXME RS subscribers are not allowed to throw
//    @Test
//    public void testOnErrorThrowsDoesntPreventDelivery() {
//        BehaviorProcessor&lt;String&gt; ps = BehaviorProcessor.create();
//
//        ps.subscribe();
//        TestSubscriber&lt;String&gt; ts = new TestSubscriber&lt;String&gt;();
//        ps.subscribe(ts);
//
//        try {
//            ps.onError(new RuntimeException(&quot;an exception&quot;));
//            fail(&quot;expect OnErrorNotImplementedException&quot;);
//        } catch (OnErrorNotImplementedException e) {
//            // ignore
//        }
//        // even though the onError above throws we should still receive it on the other subscriber
//        assertEquals(1, ts.getOnErrorEvents().size());
//    }

    // FIXME RS subscribers are not allowed to throw
//    /**
//     * This one has multiple failures so should get a CompositeException
//     */
//    @Test
//    public void testOnErrorThrowsDoesntPreventDelivery2() {
//        BehaviorProcessor&lt;String&gt; ps = BehaviorProcessor.create();
//
//        ps.subscribe();
//        ps.subscribe();
//        TestSubscriber&lt;String&gt; ts = new TestSubscriber&lt;String&gt;();
//        ps.subscribe(ts);
//        ps.subscribe();
//        ps.subscribe();
//        ps.subscribe();
//
//        try {
//            ps.onError(new RuntimeException(&quot;an exception&quot;));
//            fail(&quot;expect OnErrorNotImplementedException&quot;);
//        } catch (CompositeException e) {
//            // we should have 5 of them
//            assertEquals(5, e.getExceptions().size());
//        }
//        // even though the onError above throws we should still receive it on the other subscriber
//        assertEquals(1, ts.getOnErrorEvents().size());
//    }

    @Test
    public void testEmissionSubscriptionRace() throws Exception {
<span class="fc" id="L413">        Scheduler s = Schedulers.io();</span>
<span class="fc" id="L414">        Scheduler.Worker worker = Schedulers.io().createWorker();</span>
        try {
<span class="fc bfc" id="L416" title="All 2 branches covered.">            for (int i = 0; i &lt; 50000; i++) {</span>
<span class="fc bfc" id="L417" title="All 2 branches covered.">                if (i % 1000 == 0) {</span>
<span class="fc" id="L418">                    System.out.println(i);</span>
                }
<span class="fc" id="L420">                final BehaviorProcessor&lt;Object&gt; rs = BehaviorProcessor.create();</span>

<span class="fc" id="L422">                final CountDownLatch finish = new CountDownLatch(1);</span>
<span class="fc" id="L423">                final CountDownLatch start = new CountDownLatch(1);</span>

<span class="fc" id="L425">                worker.schedule(new Runnable() {</span>
                    @Override
                    public void run() {
                        try {
<span class="fc" id="L429">                            start.await();</span>
<span class="nc" id="L430">                        } catch (Exception e1) {</span>
<span class="nc" id="L431">                            e1.printStackTrace();</span>
<span class="fc" id="L432">                        }</span>
<span class="fc" id="L433">                        rs.onNext(1);</span>
<span class="fc" id="L434">                    }</span>
                });

<span class="fc" id="L437">                final AtomicReference&lt;Object&gt; o = new AtomicReference&lt;Object&gt;();</span>

<span class="fc" id="L439">                rs.subscribeOn(s).observeOn(Schedulers.io())</span>
<span class="fc" id="L440">                .subscribe(new DefaultSubscriber&lt;Object&gt;() {</span>

                    @Override
                    public void onComplete() {
<span class="fc" id="L444">                        o.set(-1);</span>
<span class="fc" id="L445">                        finish.countDown();</span>
<span class="fc" id="L446">                    }</span>

                    @Override
                    public void onError(Throwable e) {
<span class="nc" id="L450">                        o.set(e);</span>
<span class="nc" id="L451">                        finish.countDown();</span>
<span class="nc" id="L452">                    }</span>

                    @Override
                    public void onNext(Object t) {
<span class="fc" id="L456">                        o.set(t);</span>
<span class="fc" id="L457">                        finish.countDown();</span>
<span class="fc" id="L458">                    }</span>

                });
<span class="fc" id="L461">                start.countDown();</span>

<span class="pc bpc" id="L463" title="1 of 2 branches missed.">                if (!finish.await(5, TimeUnit.SECONDS)) {</span>
<span class="nc" id="L464">                    System.out.println(o.get());</span>
<span class="nc" id="L465">                    System.out.println(rs.hasSubscribers());</span>
<span class="nc" id="L466">                    rs.onComplete();</span>
<span class="nc" id="L467">                    Assert.fail(&quot;Timeout @ &quot; + i);</span>
<span class="nc" id="L468">                    break;</span>
                } else {
<span class="fc" id="L470">                    Assert.assertEquals(1, o.get());</span>
<span class="fc" id="L471">                    worker.schedule(new Runnable() {</span>
                        @Override
                        public void run() {
<span class="fc" id="L474">                            rs.onComplete();</span>
<span class="fc" id="L475">                        }</span>
                    });
                }
            }
        } finally {
<span class="fc" id="L480">            worker.dispose();</span>
        }
<span class="fc" id="L482">    }</span>

    @Test
    public void testCurrentStateMethodsNormalEmptyStart() {
<span class="fc" id="L486">        BehaviorProcessor&lt;Object&gt; as = BehaviorProcessor.create();</span>

<span class="fc" id="L488">        assertFalse(as.hasValue());</span>
<span class="fc" id="L489">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L490">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L491">        assertNull(as.getValue());</span>
<span class="fc" id="L492">        assertNull(as.getThrowable());</span>

<span class="fc" id="L494">        as.onNext(1);</span>

<span class="fc" id="L496">        assertTrue(as.hasValue());</span>
<span class="fc" id="L497">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L498">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L499">        assertEquals(1, as.getValue());</span>
<span class="fc" id="L500">        assertNull(as.getThrowable());</span>

<span class="fc" id="L502">        as.onComplete();</span>

<span class="fc" id="L504">        assertFalse(as.hasValue());</span>
<span class="fc" id="L505">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L506">        assertTrue(as.hasComplete());</span>
<span class="fc" id="L507">        assertNull(as.getValue());</span>
<span class="fc" id="L508">        assertNull(as.getThrowable());</span>
<span class="fc" id="L509">    }</span>

    @Test
    public void testCurrentStateMethodsNormalSomeStart() {
<span class="fc" id="L513">        BehaviorProcessor&lt;Object&gt; as = BehaviorProcessor.createDefault((Object)1);</span>

<span class="fc" id="L515">        assertTrue(as.hasValue());</span>
<span class="fc" id="L516">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L517">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L518">        assertEquals(1, as.getValue());</span>
<span class="fc" id="L519">        assertNull(as.getThrowable());</span>

<span class="fc" id="L521">        as.onNext(2);</span>

<span class="fc" id="L523">        assertTrue(as.hasValue());</span>
<span class="fc" id="L524">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L525">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L526">        assertEquals(2, as.getValue());</span>
<span class="fc" id="L527">        assertNull(as.getThrowable());</span>

<span class="fc" id="L529">        as.onComplete();</span>
<span class="fc" id="L530">        assertFalse(as.hasValue());</span>
<span class="fc" id="L531">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L532">        assertTrue(as.hasComplete());</span>
<span class="fc" id="L533">        assertNull(as.getValue());</span>
<span class="fc" id="L534">        assertNull(as.getThrowable());</span>
<span class="fc" id="L535">    }</span>

    @Test
    public void testCurrentStateMethodsEmpty() {
<span class="fc" id="L539">        BehaviorProcessor&lt;Object&gt; as = BehaviorProcessor.create();</span>

<span class="fc" id="L541">        assertFalse(as.hasValue());</span>
<span class="fc" id="L542">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L543">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L544">        assertNull(as.getValue());</span>
<span class="fc" id="L545">        assertNull(as.getThrowable());</span>

<span class="fc" id="L547">        as.onComplete();</span>

<span class="fc" id="L549">        assertFalse(as.hasValue());</span>
<span class="fc" id="L550">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L551">        assertTrue(as.hasComplete());</span>
<span class="fc" id="L552">        assertNull(as.getValue());</span>
<span class="fc" id="L553">        assertNull(as.getThrowable());</span>
<span class="fc" id="L554">    }</span>

    @Test
    public void testCurrentStateMethodsError() {
<span class="fc" id="L558">        BehaviorProcessor&lt;Object&gt; as = BehaviorProcessor.create();</span>

<span class="fc" id="L560">        assertFalse(as.hasValue());</span>
<span class="fc" id="L561">        assertFalse(as.hasThrowable());</span>
<span class="fc" id="L562">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L563">        assertNull(as.getValue());</span>
<span class="fc" id="L564">        assertNull(as.getThrowable());</span>

<span class="fc" id="L566">        as.onError(new TestException());</span>

<span class="fc" id="L568">        assertFalse(as.hasValue());</span>
<span class="fc" id="L569">        assertTrue(as.hasThrowable());</span>
<span class="fc" id="L570">        assertFalse(as.hasComplete());</span>
<span class="fc" id="L571">        assertNull(as.getValue());</span>
<span class="fc" id="L572">        assertTrue(as.getThrowable() instanceof TestException);</span>
<span class="fc" id="L573">    }</span>

    @Test
    public void cancelOnArrival() {
<span class="fc" id="L577">        BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L579">        assertFalse(p.hasSubscribers());</span>

<span class="fc" id="L581">        p.test(0L, true).assertEmpty();</span>

<span class="fc" id="L583">        assertFalse(p.hasSubscribers());</span>
<span class="fc" id="L584">    }</span>

    @Test
    public void onSubscribe() {
<span class="fc" id="L588">        BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L590">        BooleanSubscription bs = new BooleanSubscription();</span>

<span class="fc" id="L592">        p.onSubscribe(bs);</span>

<span class="fc" id="L594">        assertFalse(bs.isCancelled());</span>

<span class="fc" id="L596">        p.onComplete();</span>

<span class="fc" id="L598">        bs = new BooleanSubscription();</span>

<span class="fc" id="L600">        p.onSubscribe(bs);</span>

<span class="fc" id="L602">        assertTrue(bs.isCancelled());</span>
<span class="fc" id="L603">    }</span>

    @Test
    public void onErrorAfterComplete() {
<span class="fc" id="L607">        BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L609">        p.onComplete();</span>

<span class="fc" id="L611">        List&lt;Throwable&gt; errors = TestHelper.trackPluginErrors();</span>
        try {
<span class="fc" id="L613">            p.onError(new TestException());</span>

<span class="fc" id="L615">            TestHelper.assertUndeliverable(errors, 0, TestException.class);</span>
        } finally {
<span class="fc" id="L617">            RxJavaPlugins.reset();</span>
        }
<span class="fc" id="L619">    }</span>

    @Test
    public void cancelOnArrival2() {
<span class="fc" id="L623">        BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L625">        TestSubscriber&lt;Object&gt; ts = p.test();</span>

<span class="fc" id="L627">        p.test(0L, true).assertEmpty();</span>

<span class="fc" id="L629">        p.onNext(1);</span>
<span class="fc" id="L630">        p.onComplete();</span>

<span class="fc" id="L632">        ts.assertResult(1);</span>
<span class="fc" id="L633">    }</span>

    @Test
    public void addRemoveRace() {
<span class="fc bfc" id="L637" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_DEFAULT_LOOPS; i++) {</span>
<span class="fc" id="L638">            final BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L640">            final TestSubscriber&lt;Object&gt; ts = p.test();</span>

<span class="fc" id="L642">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L645">                    p.test();</span>
<span class="fc" id="L646">                }</span>
            };

<span class="fc" id="L649">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L652">                    ts.cancel();</span>
<span class="fc" id="L653">                }</span>
            };

<span class="fc" id="L656">            TestHelper.race(r1, r2);</span>
        }
<span class="fc" id="L658">    }</span>

    @SuppressWarnings({ &quot;rawtypes&quot;, &quot;unchecked&quot; })
    @Test
    public void subscribeOnNextRace() {
<span class="fc bfc" id="L663" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_DEFAULT_LOOPS; i++) {</span>
<span class="fc" id="L664">            final BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.createDefault((Object)1);</span>

<span class="fc" id="L666">            final TestSubscriber[] ts = { null };</span>

<span class="fc" id="L668">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L671">                    ts[0] = p.test();</span>
<span class="fc" id="L672">                }</span>
            };

<span class="fc" id="L675">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L678">                    p.onNext(2);</span>
<span class="fc" id="L679">                }</span>
            };

<span class="fc" id="L682">            TestHelper.race(r1, r2);</span>

<span class="fc bfc" id="L684" title="All 2 branches covered.">            if (ts[0].valueCount() == 1) {</span>
<span class="fc" id="L685">                ts[0].assertValue(2).assertNoErrors().assertNotComplete();</span>
            } else {
<span class="fc" id="L687">                ts[0].assertValues(1, 2).assertNoErrors().assertNotComplete();</span>
            }
        }
<span class="fc" id="L690">    }</span>

    @Test
    public void firstBackpressured() {
<span class="fc" id="L694">        BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.createDefault((Object)1);</span>

<span class="fc" id="L696">        p.test(0L, false).assertFailure(MissingBackpressureException.class);</span>

<span class="fc" id="L698">        assertFalse(p.hasSubscribers());</span>
<span class="fc" id="L699">    }</span>

    @Test
    public void offer() {
<span class="fc" id="L703">        BehaviorProcessor&lt;Integer&gt; pp = BehaviorProcessor.create();</span>

<span class="fc" id="L705">        TestSubscriber&lt;Integer&gt; ts = pp.test(0);</span>

<span class="fc" id="L707">        assertFalse(pp.offer(1));</span>

<span class="fc" id="L709">        ts.request(1);</span>

<span class="fc" id="L711">        assertTrue(pp.offer(1));</span>

<span class="fc" id="L713">        assertFalse(pp.offer(2));</span>

<span class="fc" id="L715">        ts.cancel();</span>

<span class="fc" id="L717">        assertTrue(pp.offer(2));</span>

<span class="fc" id="L719">        ts = pp.test(1);</span>

<span class="fc" id="L721">        assertTrue(pp.offer(null));</span>

<span class="fc" id="L723">        ts.assertFailure(NullPointerException.class, 2);</span>

<span class="fc" id="L725">        assertTrue(pp.hasThrowable());</span>
<span class="fc" id="L726">        assertTrue(pp.getThrowable().toString(), pp.getThrowable() instanceof NullPointerException);</span>
<span class="fc" id="L727">    }</span>

    @Test
    public void offerAsync() throws Exception {
<span class="fc" id="L731">        final BehaviorProcessor&lt;Integer&gt; pp = BehaviorProcessor.create();</span>

<span class="fc" id="L733">        Schedulers.single().scheduleDirect(new Runnable() {</span>
            @Override
            public void run() {
<span class="fc bfc" id="L736" title="All 2 branches covered.">                while (!pp.hasSubscribers()) {</span>
                    try {
<span class="fc" id="L738">                        Thread.sleep(1);</span>
<span class="nc" id="L739">                    } catch (InterruptedException ex) {</span>
<span class="nc" id="L740">                        return;</span>
<span class="fc" id="L741">                    }</span>
                }

<span class="fc bfc" id="L744" title="All 2 branches covered.">                for (int i = 1; i &lt;= 10; i++) {</span>
<span class="pc bpc" id="L745" title="1 of 2 branches missed.">                    while (!pp.offer(i)) { }</span>
                }
<span class="fc" id="L747">                pp.onComplete();</span>
<span class="fc" id="L748">            }</span>
        });

<span class="fc" id="L751">        Thread.sleep(1);</span>

<span class="fc" id="L753">        pp.test()</span>
<span class="fc" id="L754">        .awaitDone(5, TimeUnit.SECONDS)</span>
<span class="fc" id="L755">        .assertResult(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);</span>
<span class="fc" id="L756">    }</span>

    @Test
    public void completeSubscribeRace() throws Exception {
<span class="fc bfc" id="L760" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_DEFAULT_LOOPS; i++) {</span>
<span class="fc" id="L761">            final BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L763">            final TestSubscriber&lt;Object&gt; ts = new TestSubscriber&lt;Object&gt;();</span>

<span class="fc" id="L765">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L768">                    p.subscribe(ts);</span>
<span class="fc" id="L769">                }</span>
            };

<span class="fc" id="L772">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L775">                    p.onComplete();</span>
<span class="fc" id="L776">                }</span>
            };

<span class="fc" id="L779">            TestHelper.race(r1, r2);</span>

<span class="fc" id="L781">            ts.assertResult();</span>
        }
<span class="fc" id="L783">    }</span>

    @Test
    public void errorSubscribeRace() throws Exception {
<span class="fc bfc" id="L787" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_DEFAULT_LOOPS; i++) {</span>
<span class="fc" id="L788">            final BehaviorProcessor&lt;Object&gt; p = BehaviorProcessor.create();</span>

<span class="fc" id="L790">            final TestSubscriber&lt;Object&gt; ts = new TestSubscriber&lt;Object&gt;();</span>

<span class="fc" id="L792">            final TestException ex = new TestException();</span>

<span class="fc" id="L794">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L797">                    p.subscribe(ts);</span>
<span class="fc" id="L798">                }</span>
            };

<span class="fc" id="L801">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L804">                    p.onError(ex);</span>
<span class="fc" id="L805">                }</span>
            };

<span class="fc" id="L808">            TestHelper.race(r1, r2);</span>

<span class="fc" id="L810">            ts.assertFailure(TestException.class);</span>
        }
<span class="fc" id="L812">    }</span>

    @Test(timeout = 10000)
    public void subscriberCancelOfferRace() {
<span class="fc bfc" id="L816" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_DEFAULT_LOOPS; i++) {</span>
<span class="fc" id="L817">            final BehaviorProcessor&lt;Integer&gt; pp = BehaviorProcessor.create();</span>

<span class="fc" id="L819">            final TestSubscriber&lt;Integer&gt; ts = pp.test(1);</span>

<span class="fc" id="L821">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc bfc" id="L824" title="All 2 branches covered.">                    for (int i = 0; i &lt; 2; i++) {</span>
<span class="pc bpc" id="L825" title="1 of 2 branches missed.">                        while (!pp.offer(i)) { }</span>
                    }
<span class="fc" id="L827">                }</span>
            };

<span class="fc" id="L830">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L833">                    ts.cancel();</span>
<span class="fc" id="L834">                }</span>
            };

<span class="fc" id="L837">            TestHelper.race(r1, r2);</span>

<span class="pc bpc" id="L839" title="1 of 2 branches missed.">            if (ts.valueCount() &gt; 0) {</span>
<span class="nc" id="L840">                ts.assertValuesOnly(0);</span>
            } else {
<span class="fc" id="L842">                ts.assertEmpty();</span>
            }
        }
<span class="fc" id="L845">    }</span>

    @Test
    public void behaviorDisposableDisposeState() {
<span class="fc" id="L849">        BehaviorProcessor&lt;Integer&gt; bp = BehaviorProcessor.create();</span>
<span class="fc" id="L850">        bp.onNext(1);</span>

<span class="fc" id="L852">        TestSubscriber&lt;Integer&gt; ts = new TestSubscriber&lt;Integer&gt;();</span>

<span class="fc" id="L854">        BehaviorSubscription&lt;Integer&gt; bs = new BehaviorSubscription&lt;Integer&gt;(ts, bp);</span>
<span class="fc" id="L855">        ts.onSubscribe(bs);</span>

<span class="fc" id="L857">        assertFalse(bs.cancelled);</span>

<span class="fc" id="L859">        bs.cancel();</span>

<span class="fc" id="L861">        assertTrue(bs.cancelled);</span>

<span class="fc" id="L863">        bs.cancel();</span>

<span class="fc" id="L865">        assertTrue(bs.cancelled);</span>

<span class="fc" id="L867">        assertTrue(bs.test(2));</span>

<span class="fc" id="L869">        bs.emitFirst();</span>

<span class="fc" id="L871">        ts.assertEmpty();</span>

<span class="fc" id="L873">        bs.emitNext(2, 0);</span>
<span class="fc" id="L874">    }</span>

    @Test
    public void emitFirstDisposeRace() {
<span class="fc bfc" id="L878" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_LONG_LOOPS; i++) {</span>

<span class="fc" id="L880">            BehaviorProcessor&lt;Integer&gt; bp = BehaviorProcessor.create();</span>
<span class="fc" id="L881">            bp.onNext(1);</span>

<span class="fc" id="L883">            TestSubscriber&lt;Integer&gt; ts = new TestSubscriber&lt;Integer&gt;();</span>

<span class="fc" id="L885">            final BehaviorSubscription&lt;Integer&gt; bs = new BehaviorSubscription&lt;Integer&gt;(ts, bp);</span>
<span class="fc" id="L886">            ts.onSubscribe(bs);</span>

<span class="fc" id="L888">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L891">                    bs.emitFirst();</span>
<span class="fc" id="L892">                }</span>
            };
<span class="fc" id="L894">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L897">                    bs.cancel();</span>
<span class="fc" id="L898">                }</span>
            };

<span class="fc" id="L901">            TestHelper.race(r1, r2);</span>
        }
<span class="fc" id="L903">    }</span>

    @Test
    public void emitNextDisposeRace() {
<span class="fc bfc" id="L907" title="All 2 branches covered.">        for (int i = 0; i &lt; TestHelper.RACE_LONG_LOOPS; i++) {</span>

<span class="fc" id="L909">            BehaviorProcessor&lt;Integer&gt; bp = BehaviorProcessor.create();</span>
<span class="fc" id="L910">            bp.onNext(1);</span>

<span class="fc" id="L912">            TestSubscriber&lt;Integer&gt; ts = new TestSubscriber&lt;Integer&gt;();</span>

<span class="fc" id="L914">            final BehaviorSubscription&lt;Integer&gt; bs = new BehaviorSubscription&lt;Integer&gt;(ts, bp);</span>
<span class="fc" id="L915">            ts.onSubscribe(bs);</span>

<span class="fc" id="L917">            Runnable r1 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L920">                    bs.emitNext(2, 0);</span>
<span class="fc" id="L921">                }</span>
            };
<span class="fc" id="L923">            Runnable r2 = new Runnable() {</span>
                @Override
                public void run() {
<span class="fc" id="L926">                    bs.cancel();</span>
<span class="fc" id="L927">                }</span>
            };

<span class="fc" id="L930">            TestHelper.race(r1, r2);</span>
        }
<span class="fc" id="L932">    }</span>

    @Test
    public void emittingEmitNext() {
<span class="fc" id="L936">        BehaviorProcessor&lt;Integer&gt; bp = BehaviorProcessor.create();</span>
<span class="fc" id="L937">        bp.onNext(1);</span>

<span class="fc" id="L939">        TestSubscriber&lt;Integer&gt; ts = new TestSubscriber&lt;Integer&gt;();</span>

<span class="fc" id="L941">        final BehaviorSubscription&lt;Integer&gt; bs = new BehaviorSubscription&lt;Integer&gt;(ts, bp);</span>
<span class="fc" id="L942">        ts.onSubscribe(bs);</span>

<span class="fc" id="L944">        bs.emitting = true;</span>
<span class="fc" id="L945">        bs.emitNext(2, 1);</span>
<span class="fc" id="L946">        bs.emitNext(3, 2);</span>

<span class="fc" id="L948">        assertNotNull(bs.queue);</span>
<span class="fc" id="L949">    }</span>

    @Test
    public void badRequest() {
<span class="fc" id="L953">        List&lt;Throwable&gt; errors = TestHelper.trackPluginErrors();</span>
        try {
<span class="fc" id="L955">            BehaviorProcessor&lt;Integer&gt; bp = BehaviorProcessor.create();</span>
<span class="fc" id="L956">            bp.onNext(1);</span>

<span class="fc" id="L958">            TestSubscriber&lt;Integer&gt; ts = new TestSubscriber&lt;Integer&gt;();</span>

<span class="fc" id="L960">            final BehaviorSubscription&lt;Integer&gt; bs = new BehaviorSubscription&lt;Integer&gt;(ts, bp);</span>
<span class="fc" id="L961">            ts.onSubscribe(bs);</span>

<span class="fc" id="L963">            bs.request(-1);</span>

<span class="fc" id="L965">            TestHelper.assertError(errors, 0, IllegalArgumentException.class);</span>
        } finally {
<span class="fc" id="L967">            RxJavaPlugins.reset();</span>
        }
<span class="fc" id="L969">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>